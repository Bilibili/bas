!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("BasDanmaku",[],t):"object"==typeof exports?exports.BasDanmaku=t():e.BasDanmaku=t()}(window,function(){return function(r){var a={};function s(e){if(a[e])return a[e].exports;var t=a[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,s),t.l=!0,t.exports}return s.m=r,s.c=a,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(r,a,function(e){return t[e]}.bind(null,a));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=7)}([function(e,t,r){e.exports=function(){return r(6)(
'!function(r){var a={};function s(e){if(a[e])return a[e].exports;var t=a[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,s),t.l=!0,t.exports}s.m=r,s.c=a,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(r,a,function(e){return t[e]}.bind(null,a));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,r){"use strict";r.r(t);var u=function(e,t){var r={};for(var a in e)e.hasOwnProperty(a)&&(r[a]=e[a]);for(var a in t)t.hasOwnProperty(a)&&(r[a]=t[a]);return r},l=function(e,t,r){return r||(e=e.replace(/&/g,"").replace(/</g,"").replace(/>/g,"").replace(/"/g,"").replace(/\'/g,"").replace(/\\//g,"").replace(/:/g,"").replace(/;/g,"")),e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\'/g,"&#x27;").replace(/\\//g,"&#x2f;").replace(/ /g,t?" ":"&nbsp;").replace(/\\n/g,"<br>")},c=4294967295,h=4294967295,a=function(){function s(){this.transTable=[[!1,[4294967295,2,1],[[0,35,0],[36,36,1],[37,37,2]]],[!1,[4294967295,20,23,22,21,12,19,18,17,16,15,14,13,11,10,9,8,7,6,5,4,3],[[0,2,0],[3,3,1],[4,4,2],[5,5,3],[6,6,4],[7,7,5],[8,8,6],[9,9,7],[10,10,8],[11,11,9],[12,12,10],[13,13,11],[14,14,12],[15,15,13],[16,16,14],[17,17,15],[18,18,16],[19,30,17],[31,31,18],[32,32,19],[33,34,20],[35,35,21],[36,37,0]]],[!1,[26,24,25,4294967295],[[0,0,0],[1,16,1],[17,17,2],[18,32,1],[33,33,3],[34,35,1],[36,37,3]]],[!1,[4294967295,27],[[0,34,0],[35,35,1],[36,37,0]]],[!1,[4294967295,4],[[0,32,0],[33,34,1],[35,37,0]]],[!1,[4294967295,33,13,31,30,29,32,28],[[0,6,0],[7,7,1],[8,13,0],[14,14,2],[15,24,0],[25,26,3],[27,27,4],[28,29,5],[30,30,6],[31,31,7],[32,32,2],[33,37,0]]],[!1,[4294967295,34],[[0,13,0],[14,14,1],[15,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,7],[[0,6,0],[7,7,1],[8,10,0],[11,11,1],[12,12,0],[13,14,1],[15,18,0],[19,30,1],[31,31,0],[32,32,1],[33,37,0]]],[!0],[!0],[!0],[!0],[!1,[4294967295,7,35],[[0,6,0],[7,7,1],[8,10,0],[11,11,1],[12,12,0],[13,14,1],[15,18,0],[19,27,1],[28,28,2],[29,30,1],[31,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,33,13,30,29,32,28],[[0,6,0],[7,7,1],[8,13,0],[14,14,2],[15,26,0],[27,27,3],[28,29,4],[30,30,5],[31,31,6],[32,32,2],[33,37,0]]],[!1,[4294967295,7,36],[[0,6,0],[7,7,1],[8,10,0],[11,11,1],[12,12,0],[13,14,1],[15,18,0],[19,29,1],[30,30,2],[31,31,0],[32,32,1],[33,37,0]]],[!0],[!1,[4294967295,7,37],[[0,6,0],[7,7,1],[8,10,0],[11,11,1],[12,12,0],[13,14,1],[15,18,0],[19,27,1],[28,28,2],[29,30,1],[31,31,0],[32,32,1],[33,37,0]]],[!0],[!0],[!0],[!0],[!0],[!0],[!0],[!0],[!0],[!1,[38,4294967295,40,39],[[0,0,0],[1,1,1],[2,2,0],[3,12,1],[13,13,0],[14,16,1],[17,17,0],[18,21,1],[22,23,0],[24,24,2],[25,25,1],[26,26,3],[27,37,1]]],[!1,[27,41,4294967295],[[0,32,0],[33,33,1],[34,35,0],[36,37,2]]],[!1,[4294967295,34],[[0,13,0],[14,14,1],[15,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,42,43],[[0,13,0],[14,14,1],[15,15,0],[16,16,2],[17,17,0],[18,18,2],[19,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,46,44,45],[[0,6,0],[7,7,1],[8,13,0],[14,14,2],[15,30,0],[31,31,3],[32,32,2],[33,37,0]]],[!1,[4294967295,47],[[0,10,0],[11,11,1],[12,13,0],[14,14,1],[15,19,0],[20,21,1],[22,27,0],[28,29,1],[30,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,48,49],[[0,13,0],[14,14,1],[15,30,0],[31,31,2],[32,32,1],[33,37,0]]],[!1,[4294967295,50,51],[[0,13,0],[14,14,1],[15,30,0],[31,31,2],[32,32,1],[33,37,0]]],[!1,[4294967295,33,34,30,29,32],[[0,6,0],[7,7,1],[8,13,0],[14,14,2],[15,26,0],[27,27,3],[28,29,4],[30,30,5],[31,31,0],[32,32,2],[33,37,0]]],[!1,[4294967295,7,52],[[0,6,0],[7,7,1],[8,10,0],[11,11,1],[12,12,0],[13,\n13,2],[14,14,1],[15,18,0],[19,30,1],[31,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,7,53],[[0,6,0],[7,7,1],[8,10,0],[11,11,1],[12,12,0],[13,14,1],[15,18,0],[19,27,1],[28,28,2],[29,30,1],[31,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,7,54],[[0,6,0],[7,7,1],[8,10,0],[11,11,1],[12,12,0],[13,14,1],[15,18,0],[19,20,1],[21,21,2],[22,30,1],[31,31,0],[32,32,1],[33,37,0]]],[!0],[!1,[4294967295,55],[[0,10,0],[11,11,1],[12,13,0],[14,14,1],[15,19,0],[20,21,1],[22,27,0],[28,29,1],[30,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,56],[[0,10,0],[11,11,1],[12,13,0],[14,14,1],[15,19,0],[20,21,1],[22,27,0],[28,29,1],[30,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,41],[[0,32,0],[33,33,1],[34,37,0]]],[!1,[4294967295,33,42,30,32],[[0,6,0],[7,7,1],[8,13,0],[14,14,2],[15,26,0],[27,27,3],[28,29,0],[30,30,4],[31,31,0],[32,32,2],[33,37,0]]],[!1,[4294967295,42],[[0,13,0],[14,14,1],[15,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,33,44,58,57,45],[[0,6,0],[7,7,1],[8,13,0],[14,14,2],[15,26,0],[27,27,3],[28,29,4],[30,30,0],[31,31,5],[32,32,2],[33,37,0]]],[!1,[4294967295,59],[[0,13,0],[14,14,1],[15,31,0],[32,32,1],[33,37,0]]],[!0],[!1,[4294967295,47],[[0,10,0],[11,11,1],[12,13,0],[14,14,1],[15,19,0],[20,21,1],[22,27,0],[28,29,1],[30,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,33,48,30,60,49],[[0,6,0],[7,7,1],[8,13,0],[14,14,2],[15,26,0],[27,27,3],[28,29,4],[30,30,0],[31,31,5],[32,32,2],[33,37,0]]],[!1,[4294967295,61],[[0,13,0],[14,14,1],[15,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,50,58,62,51],[[0,13,0],[14,14,1],[15,26,0],[27,27,2],[28,29,3],[30,30,0],[31,31,4],[32,32,1],[33,37,0]]],[!1,[4294967295,63],[[0,13,0],[14,14,1],[15,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,7],[[0,6,0],[7,7,1],[8,10,0],[11,11,1],[12,12,0],[13,14,1],[15,18,0],[19,30,1],[31,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,7,64],[[0,6,0],[7,7,1],[8,10,0],[11,11,1],[12,12,0],[13,14,1],[15,18,0],[19,22,1],[23,23,2],[24,30,1],[31,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,7],[[0,6,0],[7,7,1],[8,10,0],[11,11,1],[12,12,0],[13,14,1],[15,18,0],[19,30,1],[31,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,65],[[0,10,0],[11,11,1],[12,13,0],[14,14,1],[15,19,0],[20,21,1],[22,27,0],[28,29,1],[30,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,66],[[0,10,0],[11,11,1],[12,13,0],[14,14,1],[15,19,0],[20,21,1],[22,27,0],[28,29,1],[30,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,67,68],[[0,13,0],[14,14,1],[15,15,0],[16,16,2],[17,17,0],[18,18,2],[19,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,46],[[0,6,0],[7,7,1],[8,37,0]]],[!1,[4294967295,33,59,58,57],[[0,6,0],[7,7,1],[8,13,0],[14,14,2],[15,26,0],[27,27,3],[28,29,4],[30,31,0],[32,32,2],[33,37,0]]],[!1,[4294967295,69,70],[[0,13,0],[14,14,1],[15,15,0],[16,16,2],[17,17,0],[18,18,2],[19,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,33,61,30,60],[[0,6,0],[7,7,1],[8,13,0],[14,14,2],[15,26,0],[27,27,3],[28,29,4],[30,31,0],[32,32,2],[33,37,0]]],[!1,[4294967295,71,72],[[0,13,0],[14,14,1],[15,15,0],[16,16,2],[17,17,0],[18,18,2],[19,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,63,58,62],[[0,13,0],[14,14,1],[15,26,0],[27,27,2],[28,29,3],[30,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,7],[[0,6,0],[7,7,1],[8,10,0],[11,11,1],[12,12,0],[13,14,1],[15,18,0],[19,30,1],[31,31,0],[32,32,1],[33,37,0]]],[!0],[!1,[4294967295,73],[[0,10,0],[11,11,1],[12,13,0],[14,14,1],[15,19,0],[20,21,1],[22,27,0],[28,29,1],[30,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,33,67,58],[[0,6,0],[7,7,1],[8,13,0],[14,14,2],[15,26,0],[27,27,3],[28,31,0],[32,32,2],[33,37,0]]],[!1,[4294967295,67],[[0,13,0],[14,14,1],[15,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,33,69,30],[[0,6,0],[7,7,1],[8,13,0],[14,14,2],[15,26,0],[27,27,3],[28,31,0],[32,32,2],[33,37,0]]],[!1,[4294967295,69],[[0,13,0],[14,14,1],[15,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,71,58],[[0,13,0],[14,14,1],[15,26,0],[27,27,2],[28,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,71],[[0,13,0],[14,14,1],[15,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,74],[[0,10,0],[11,11,1],[12,13,0],[14,14,1],[15,19,0],[20,21,1],[22,27,0],[28,29,1],[30,31,0],[32,32,1],[33,37,0]]],[!0]],this.finalTable={64:15,65:10,4:1,5:3,6:23,7:26,8:5,9:7,10:6,11:24,12:26,13:3,\n14:26,15:21,16:26,17:16,18:19,19:20,20:25,21:17,22:18,23:22,24:12,25:11,74:9,30:2,32:2,33:2,34:3,35:26,36:26,37:26,38:8,41:0,42:3,27:0,46:2,47:4,52:13,53:26,54:14},this.inputTable=[[0,8,1],[9,9,34],[10,10,33],[11,11,1],[12,12,34],[13,13,33],[14,31,1],[32,32,34],[33,33,1],[34,34,17],[35,35,1],[36,36,19],[37,37,3],[38,38,1],[39,39,2],[40,40,6],[41,41,5],[42,42,1],[43,43,18],[44,44,15],[45,45,16],[46,46,31],[47,47,35],[48,48,32],[49,57,14],[58,60,1],[61,61,10],[62,63,1],[64,64,19],[65,68,20],[69,69,29],[70,70,20],[71,87,19],[88,88,25],[89,90,19],[91,91,9],[92,92,0],[93,93,8],[94,94,1],[95,95,19],[96,96,1],[97,99,20],[100,100,11],[101,101,28],[102,102,21],[103,103,19],[104,104,30],[105,108,19],[109,109,27],[110,110,23],[111,113,19],[114,114,22],[115,115,7],[116,116,13],[117,117,24],[118,119,19],[120,120,26],[121,122,19],[123,123,12],[124,124,1],[125,125,4],[126,65535,1]],this.initialTable={INITIAL:2,STRING:1}}return s.lexSeq=function(e){var t=new s;t.source=e;for(var r=[],a=t.token;"<$>"!==a;)r.push({token:a,text:t.yytext,start:t.startIdx,end:t.endIdx}),t.advance(),a=t.token;return r},s.prototype.yyrestart=function(e){void 0===e&&(e=null),null!=e&&(this.sourceString=e),this.ended=!1,this.start=0,this.oldStart=0,this.line=1,this.col=0,this.advanced=!0,this.tokenNameString=null,this.yyObject={},this.initialState="INITIAL"},Object.defineProperty(s.prototype,"source",{set:function(e){this.sourceString=e,this.yyrestart()},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"token",{get:function(){return this.advanced&&(this.tokenNameString=this.next(),this.advanced=!1),this.tokenNameString},enumerable:!0,configurable:!0}),s.prototype.advance=function(){this.advanced=!0},Object.defineProperty(s.prototype,"startIdx",{get:function(){return this.oldStart},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"endIdx",{get:function(){return this.start},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"position",{get:function(){return[this.line,this.col]},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"positionInfo",{get:function(){return this.token+"@row:"+this.position.join("col:")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"yytext",{get:function(){return this.yyText},set:function(e){this.yyText=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"yyleng",{get:function(){return this.endIdx-this.startIdx},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"yy",{get:function(){return this.yyObject},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"tokenName",{get:function(){return this.tokenNameString},enumerable:!0,configurable:!0}),s.prototype.next=function(){for(var e,t,r,a,s,n,i,p,o;;)for(t=e=null,r=0,a=this.start,s=this.start,n=h,p=c,o=this.start,i=this.transTable[0][1][this.initialInput];;){if(r=this.sourceString.charCodeAt(s),n!==h&&(13===r?(this.col=0,this.line++):10===r?13!==n&&(this.col=0,this.line++):this.col++),n=r,(t=this.trans(i,r))===c){if(a===o){if(this.start!==this.sourceString.length)throw new Error("意外的字符,line:"+this.position.join(",col:")+"of "+this.sourceString.substr(a,20));if(!1===this.ended)return this.ended=!0,"<$>";throw new Error("已经到达末尾.")}switch(e=this.finalTable[p],this.start=o,this.oldStart=a,this.yyText=this.sourceString.substring(this.startIdx,this.endIdx),e){case 2:return"time";case 3:return"number";case 4:return"hex";case 5:return"+";case 6:return"-";case 7:return this.begin("STRING"),"str_start";case 8:return"str_esc_char";case 9:return"str_esc_unicode";case 10:return"str_esc_ascii";case 11:return this.begin("INITIAL"),"str_end";case 12:return"str_seg";case 13:return"set";case 14:return"def";case 15:return"then";case 16:return"=";case 17:return"(";case 18:return")";case 19:return"[";case 20:return"]";case 21:return"{";case 22:return"}";case 23:return".";case 24:return",";case 25:return"%";case 26:return"id"}break}null!=(e=this.finalTable[t])&&(p=t,o=s+1),s+=1,i=t}},s.prototype.trans=function(e,t){if(isNaN(t))return c;if(\nt<this.inputTable[0][0]||t>this.inputTable[this.inputTable.length-1][1])throw new Error("输入超出有效范围,line:"+this.position.join(",col:"));if(!0===this.transTable[e][0])return c;var r=this.find(t,this.inputTable),a=this.find(r,this.transTable[e][2]);return this.transTable[e][1][a]},s.prototype.find=function(e,t){var r,a,s;for(r=0,a=t.length-1;;){if(t[s=r+a>>>1][0]<=e&&t[s][1]>=e)return t[s][2];t[s][0]>e?a=s-1:r=s+1}},s.prototype.begin=function(e){void 0===e&&(e=null),this.initialState=null!=e?e:"INITIAL"},Object.defineProperty(s.prototype,"initialState",{get:function(){return this.initialStateString},set:function(e){if(void 0===this.initialTable[e])throw new Error("未定义的起始状态:"+e);this.initialStateString=e,this.initialInput=this.initialTable[e]},enumerable:!0,configurable:!0}),s}(),m=function(){function r(){this.actionTable=[null,{0:6,1:1,2:2,35:14,38:48,7:4,8:8,9:10,10:12,44:44,45:38,46:54,47:52,73:86,70:46,24:42,71:50,27:40},{11:41,20:20,21:22,22:16,28:18},{32:26,19:28,42:24,35:14,29:32,30:30,31:73},{0:6,2:9,81:74,4:29,69:78,6:35,7:4,8:8,9:10,10:12,12:43,70:46,71:50,16:55,64:58,18:43,19:61,78:169,23:58,24:42,72:77,73:86,27:40,66:106,82:102,79:104,33:77,34:58,35:14,36:61,38:48,39:56,41:77,43:99,44:44,45:38,46:54,47:52,49:72,50:70,80:76,55:68,56:60,57:62,58:64,59:66,61:98,62:100},{10:39,3:27,35:14,29:27,30:39},{38:48,71:50,40:37,9:37,44:44,45:38,70:46,73:86,18:45,12:45,14:37,24:42,25:37,27:40},{32:26,35:14,68:159,69:78,73:86,42:24,67:112,44:129,83:110,80:76,49:72,50:70,19:28,84:108,55:68,81:74,59:66,29:32,30:30,31:75},{0:6,70:46,2:11,35:14,5:11,38:48,7:4,8:8,9:10,10:12,44:44,45:38,14:36,15:11,17:11,34:11,71:50,46:54,47:52,24:42,25:34,73:86,27:40},{0:6,2:13,5:13,70:46,7:4,8:8,9:10,10:12,13:49,14:36,15:13,17:13,71:50,25:34,26:71,27:40,24:42,34:13,35:14,73:86,38:48,44:44,45:38,46:54,47:52,48:131},{64:58,66:106,69:78,70:46,71:50,72:167,73:86,14:36,15:51,80:76,81:74,82:102,23:58,24:42,25:34,27:40,79:104,33:79,34:58,38:48,39:56,40:95,41:97,44:44,45:38,49:72,50:70,55:68,56:60,57:62,58:64,59:66,61:98,62:100},{78:101,43:101,54:101,38:91},{0:6,2:15,35:14,38:48,7:4,8:8,9:10,10:12,44:44,45:38,46:54,47:52,73:86,70:46,24:42,71:50,27:40},{37:89},{78:103,54:103,43:103},{78:84,51:80,52:82,60:141,43:84,54:84},{69:163},{78:105,54:105,43:105},{78:107,54:107,43:107},{78:109,43:109,54:109,63:109},{65:149,74:88,75:90,76:92,53:96,77:94},{65:151,74:88,75:90,76:92,53:96,77:94},{65:153,74:88,75:90,76:92,53:96,77:94},{65:155,74:88,75:90,76:92,53:96,77:94},{65:157,74:88,75:90,76:92,53:96,77:94},{43:111},{67:112,68:161,69:78,73:86,80:76,49:72,50:70,83:110,84:108,54:135,55:68,81:74,59:66}],this.gotoTable={27:{0:5},28:{0:7},29:{2:17},30:{2:19},31:{17:57,2:21,34:83,5:31,15:53},32:{36:63,2:23,19:63},33:{36:25,2:25,19:25},34:{19:65},35:{12:47,18:59},36:{36:87,19:67},37:{5:33},38:{64:147,34:85,23:69},39:{38:93},40:{63:143},41:{78:113,43:113,54:113,63:145},42:{72:81,33:81,41:81},43:{43:115},44:{78:171,54:137,43:117},45:{43:119},46:{78:121,54:121,43:121},47:{78:123,54:123,43:123},48:{69:165},49:{53:133},50:{43:125},51:{43:127},52:{54:139}},this.prodList=[[53,2],[27,1],[28,2],[28,0],[29,1],[29,1],[29,1],[32,4],[33,3],[33,3],[35,1],[35,1],[34,3],[34,1],[34,0],[36,1],[36,1],[37,2],[37,1],[31,6],[31,3],[31,3],[39,1],[39,3],[39,0],[40,1],[30,6],[30,6],[38,2],[38,0],[42,3],[43,1],[43,1],[44,1],[44,1],[44,1],[44,1],[46,3],[48,1],[48,0],[47,1],[47,1],[47,0],[41,3],[49,2],[49,2],[49,2],[49,2],[49,0],[45,1],[45,1],[51,4],[50,3],[50,2],[52,3],[52,3],[52,1]],this.inputTable={"<$>":1,"(":2,")":3,id:4,".":5,then:6,",":7,set:8,"{":9,"}":10,time:11,def:12,"=":13,hex:14,number:15,"%":16,"+":17,"-":18,str_start:19,str_end:20,str_esc_char:21,str_esc_unicode:22,str_esc_ascii:23,str_seg:24,"[":25,"]":26}}return r.parse=function(e){var t=new a;return t.source=e,(new r).parseLexer(t)},r.prototype.parseLexer=function(e){for(var t,r,a,s=[0],n=[];;){if(r=e.token,t=s[s.length-1],null==this.actionTable[this.inputTable[r]][t])throw new Error("Parse Error:"+e.positionInfo);if(1===(a=this.actionTable[this.inputTable[r]][t]))return n.pop();if(1==(1&a))n.push(e.yytext),s.push((a>>>1)-1),e.advance(\n);else if(0==(1&a)){var i=a>>>1,p=this.prodList[i][1],o=null;switch(0<p&&(o=n[n.length-p]),i){case 1:o={type:"GlobalExprs",params:n[n.length-1]};break;case 2:(o=n[n.length-2]).push(n[n.length-1]);break;case 3:o=[];break;case 4:o={type:"DefExpr",params:n[n.length-1]};break;case 5:o={type:"SetExpr",params:n[n.length-1]};break;case 6:o={type:"CallExpr",params:n[n.length-1]};break;case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:break;case 17:(o=n[n.length-2]).push(n[n.length-1]);break;case 18:o=[n[n.length-1]];break;case 19:o={type:"UnitSetExpr",params:[n[n.length-5],n[n.length-3],n[n.length-1]]};break;case 20:o={type:"ThenSetExpr",params:[n[n.length-3],n[n.length-1]]};break;case 21:o={type:"GroupSetExpr",params:n[n.length-2]};break;case 22:o={type:"SetExprParams",params:[n[n.length-1]]};break;case 23:o={type:"SetExprParams",params:[n[n.length-3],n[n.length-1]]};break;case 24:o={type:"SetExprParams",params:[]};break;case 25:break;case 26:o={type:"NormalDefExpr",params:[n[n.length-5],n[n.length-4],n[n.length-2]]};break;case 27:o={type:"TweenDefExpr",params:[n[n.length-5],n[n.length-4],n[n.length-2]]};break;case 28:(o=n[n.length-2]).push(n[n.length-1]);break;case 29:o=[];break;case 30:o={type:"ASetter",params:[n[n.length-3],n[n.length-1]]};break;case 31:o={type:"SimpleValue",value:n[n.length-1]};break;case 32:break;case 33:o={type:"Num",value:n[n.length-1]};break;case 34:break;case 35:o={type:"hex",value:n[n.length-1]};break;case 36:o={type:"time",value:n[n.length-1]};break;case 37:o=[n[n.length-3],n[n.length-2],n[n.length-1]];break;case 38:case 39:case 40:case 41:break;case 42:o="+";break;case 43:o={type:"String",value:n[n.length-2]};break;case 44:(o=n[n.length-2]).push({type:"char",value:n[n.length-1]});break;case 45:(o=n[n.length-2]).push({type:"unicode",value:n[n.length-1]});break;case 46:(o=n[n.length-2]).push({type:"ascii",value:n[n.length-1]});break;case 47:(o=n[n.length-2]).push({type:"seg",value:n[n.length-1]});break;case 48:o=[];break;case 49:case 50:o={type:"ComplexValue",value:n[n.length-1]};break;case 51:o={type:"Object",params:[n[n.length-4],n[n.length-2]]};break;case 52:o={type:"Array",params:n[n.length-2]};break;case 53:o={type:"Array",params:[]};break;case 54:case 55:(o=n[n.length-3]).push(n[n.length-1]);break;case 56:o=[n[n.length-1]]}for(var u=0;u<p;)s.pop(),n.pop(),u++;if(t=s[s.length-1],null==this.gotoTable[this.prodList[i][0]][t])throw new Error("Goto Error!"+e.positionInfo);a=this.gotoTable[this.prodList[i][0]][t],s.push((a>>>1)-1),n.push(o)}}},r}(),f=function(){function e(e,t){this.ast=e,this.encode=t,this.defTypeInfo={}}return e.prototype.transform=function(){for(var e=[],t=[],r=0,a=this.ast.params;r<a.length;r++){var s=a[r];switch(s.type){case"SetExpr":e.push(this.trans(s.params));break;case"DefExpr":var n=s.params;switch(n.type){case"NormalDefExpr":var i=n.params[0],p=n.params[1];switch(i){case"text":case"button":case"path":this.defTypeInfo[p]=i}t.push(n)}}}return t=t.map(this.transDef.bind(this)).filter(function(e){return null!=e}),{sets:e=e.map(this.transSet.bind(this)).filter(function(e){return null!=e}),defs:t}},e.prototype.trans=function(e){if("ThenSetExpr"!==e.type)return"GroupSetExpr"===e.type?(e.params=e.params.map(this.trans.bind(this)).filter(function(e){return null!=e}),e):"UnitSetExpr"===e.type?e:void 0;var t=this.trans(e.params[0]),r=this.trans(e.params[1]);return"ThenSetExpr"===t.type?(t.params.push(r),t):(e.params=[t,r],e)},e.prototype.transDef=function(e){if("NormalDefExpr"===e.type&&3===e.params.length){var t=e.params[0],r=e.params[1],a=e.params[2];if("text"===t){for(var s={type:"DefText",name:r,attrs:{}},n=0,i=a;n<i.length;n++){var p=i[n];this.transAsetterNV(p,s)}return s}if("button"===t){s={type:"DefButton",name:r,attrs:{}};for(var o=0,u=a;o<u.length;o++){p=u[o];this.transAsetterNV(p,s)}return s}if("path"===t){s={type:"DefPath",name:r,attrs:{}};for(var l=0,c=a;l<c.length;l++){p=c[l];this.transAsetterNV(p,s)}return s}}},e.prototype.transAsetterNV=function(e,t){if("DefText"===t.type){var r=e.params[0];e.params[1];switch(r){case"content":\nt.attrs.content=this.parseString(e.params[1],!1,!0);break;case"fontFamily":t.attrs.fontFamily=this.parseString(e.params[1],!0);break;case"fontSize":t.attrs.fontSize=this.parseNum(e.params[1]);break;case"x":t.attrs.x=this.parseNum(e.params[1]);break;case"y":t.attrs.y=this.parseNum(e.params[1]);break;case"alpha":t.attrs.alpha=this.parseNum(e.params[1]);break;case"anchorX":t.attrs.anchorX=this.parseNum(e.params[1]);break;case"anchorY":t.attrs.anchorY=this.parseNum(e.params[1]);break;case"color":t.attrs.color=this.parseInteger(e.params[1]);break;case"zIndex":t.attrs.zIndex=this.parseInteger(e.params[1]);break;case"parent":t.attrs.parent=this.parseString(e.params[1]);break;case"bold":t.attrs.bold=this.parseInteger(e.params[1]);break;case"textShadow":t.attrs.textShadow=this.parseInteger(e.params[1]);break;case"strokeWidth":t.attrs.strokeWidth=this.parseInteger(e.params[1]);break;case"strokeColor":t.attrs.strokeColor=this.parseInteger(e.params[1]);break;case"rotateX":t.attrs.rotateX=this.parseNum(e.params[1]);break;case"rotateY":t.attrs.rotateY=this.parseNum(e.params[1]);break;case"rotateZ":t.attrs.rotateZ=this.parseNum(e.params[1]);break;case"scale":t.attrs.scale=this.parseNum(e.params[1]);break;case"duration":t.attrs.duration=this.parseTime(e.params[1])}}else if("DefButton"===t.type){r=e.params[0],e.params[1];switch(r){case"text":t.attrs.text=this.parseString(e.params[1],!1,!0);break;case"fontSize":t.attrs.fontSize=this.parseNum(e.params[1]);break;case"textColor":t.attrs.textColor=this.parseInteger(e.params[1]);break;case"textAlpha":t.attrs.textAlpha=this.parseNum(e.params[1]);break;case"fillColor":t.attrs.fillColor=this.parseInteger(e.params[1]);break;case"fillAlpha":t.attrs.fillAlpha=this.parseNum(e.params[1]);break;case"x":t.attrs.x=this.parseNum(e.params[1]);break;case"y":t.attrs.y=this.parseNum(e.params[1]);break;case"duration":t.attrs.duration=this.parseTime(e.params[1]);break;case"target":t.attrs.target=this.parseObject(e.params[1]);break;case"zIndex":t.attrs.zIndex=this.parseInteger(e.params[1]);break;case"scale":t.attrs.scale=this.parseNum(e.params[1])}}else if("DefPath"===t.type){r=e.params[0],e.params[1];switch(r){case"d":t.attrs.d=this.parseString(e.params[1],!0);break;case"viewBox":t.attrs.viewBox=this.parseString(e.params[1],!0);break;case"fillColor":t.attrs.fillColor=this.parseInteger(e.params[1]);break;case"fillAlpha":t.attrs.fillAlpha=this.parseNum(e.params[1]);break;case"borderColor":t.attrs.borderColor=this.parseInteger(e.params[1]);break;case"borderAlpha":t.attrs.borderAlpha=this.parseNum(e.params[1]);break;case"borderWidth":t.attrs.borderWidth=this.parseNum(e.params[1]);break;case"x":t.attrs.x=this.parseNum(e.params[1]);break;case"y":t.attrs.y=this.parseNum(e.params[1]);break;case"scale":t.attrs.scale=this.parseNum(e.params[1]);break;case"width":t.attrs.width=this.parseNum(e.params[1]);break;case"height":t.attrs.height=this.parseNum(e.params[1]);break;case"duration":t.attrs.duration=this.parseTime(e.params[1]);break;case"zIndex":t.attrs.zIndex=this.parseInteger(e.params[1])}}},e.prototype.parseString=function(e,t,r){if(void 0===t&&(t=!1),void 0===r&&(r=!1),"SimpleValue"===e.type)return this.parseString2(e.value,t,r)},e.prototype.parseString2=function(e,t,r){if(void 0===t&&(t=!1),void 0===r&&(r=!1),"String"===e.type){for(var a=[],s=0,n=e.value;s<n.length;s++){var i=n[s];switch(i.type){case"char":var p=null;switch(i.value.charAt(1)){case"n":p="\\n";break;case"r":p="\\r";break;case"t":p="\\t";break;case"\\\\":p="\\\\";break;case"\'":p="\'";break;case\'"\':p=\'"\';break;default:p=i.charAt(1)}a.push(p);break;case"unicode":case"ascii":var o=i.value.substr(2);a.push(String.fromCharCode(parseInt(o,16)));break;case"seg":a.push(i.value)}}return this.encode?l(a.join(""),t,r):a.join("")}},e.prototype.parseNum=function(e){if("SimpleValue"===e.type)return this.parseNum2(e.value)},e.prototype.parseNum2=function(e){if("Num"===e.type){var t="+"===e.value[0]?1:-1,r=e.value[1];return{numType:"%"===e.value[2]?"percent":"number",value:t*parseFloat(r)}}},e.prototype.parseInteger=function(e){if("SimpleValue"===e.type\n)return this.parseInteger2(e.value)},e.prototype.parseInteger2=function(e){return"hex"===e.type?parseInt(e.value.substr(2),16):"Num"===e.type?Math.floor(this.parseNum2(e).value):void 0},e.prototype.transSet=function(e){if("ThenSetExpr"===e.type||"GroupSetExpr"===e.type){var t=e.params.map(this.transSet.bind(this)).filter(function(e){return null!=e});if(0<t.length)return{type:"ThenSetExpr"===e.type?"Serial":"Parallel",items:t}}else if("UnitSetExpr"===e.type){var r=e.params[0],a=this.defTypeInfo[r],s=this.parseSetExprParams(e.params[2]),n=s[0],i=s[1];if("text"!==a&&"button"!==a&&"path"!==a)return null;for(var p={type:"Unit",duration:n,defaultEasing:i,targetName:r,attrs:{}},o=0,u=e.params[1];o<u.length;o++){var l=u[o];this.transAsetter(a,l,p.attrs)}return p}},e.prototype.parseSetExprParams=function(e){var t=0,r=null;return"SetExprParams"===e.type&&(1<=e.params.length&&(t=this.parseTime2(e.params[0])),2<=e.params.length&&(r=this.parseString2(e.params[1]))),[t,r]},e.prototype.parseTime=function(e){if("SimpleValue"===e.type&&"time"===e.value.type)return this.parseTime2(e.value.value)},e.prototype.parseTime2=function(e){for(var t=!0,r=0,a=0,s="",n=null;;){if(null==(n=t?e.match(/^(\\d*\\.?\\d+(?:[eE][\\+\\-]?\\d+)?)(.*)$/):e.match(/^([hms]+)(.*)$/)))return r;if(s=n[1],t)a=parseFloat(s);else switch(s){case"h":r+=3600*a*1e3;break;case"m":r+=60*a*1e3;break;case"s":r+=1e3*a;break;case"ms":r+=a}e=n[2],t=!t}},e.prototype.parseObject=function(e){if("ComplexValue"===e.type&&"Object"===e.value.type)return this.parseObject2(e.value)},e.prototype.parseObject2=function(e){var t=e.params[0],r=e.params[1],a={};switch(t){case"seek":a.objType="seek";for(var s=0,n=r;s<n.length;s++){if("ASetter"===(h=n[s]).type){var i=h.params[0],p=h.params[1];switch(i){case"time":a.time=this.parseTime(p)}}}break;case"av":a.objType="av";for(var o=0,u=r;o<u.length;o++){if("ASetter"===(h=u[o]).type){i=h.params[0],p=h.params[1];switch(i){case"av":a.av=this.parseInteger(p);break;case"page":a.page=this.parseInteger(p);break;case"time":a.time=this.parseTime(p)}}}break;case"bangumi":a.objType="bangumi";for(var l=0,c=r;l<c.length;l++){var h;if("ASetter"===(h=c[l]).type){i=h.params[0],p=h.params[1];switch(i){case"seasonId":a.seasonId=this.parseInteger(p);break;case"episodeId":a.episodeId=this.parseInteger(p);break;case"time":a.time=this.parseTime(p)}}}}return a},e.prototype.transAsetter=function(e,t,r){if("ASetter"===t.type&&2===t.params.length){var a=t.params[0],s=this.transAsetterValue(t.params[1]),n=s[0],i=s[1];if("text"===e)switch(a){case"x":case"y":case"alpha":case"color":case"fontSize":case"content":case"rotateX":case"rotateY":case"rotateZ":case"scale":r[a]={value:n,easing:i}}else if("button"===e)switch(a){case"x":case"y":case"fontSize":case"text":r[a]={value:n,easing:i}}else if("path"===e)switch(a){case"x":case"y":r[a]={value:n,easing:i}}}},e.prototype.transAsetterValue=function(e){return"SimpleValue"===e.type?[this.transValue(e.value),null]:"ComplexValue"===e.type&&"Array"===e.value.type&&2===e.value.params.length?[this.transValue(e.value.params[0]),this.parseString2(e.value.params[1])]:[null,null]},e.prototype.transValue=function(e){switch(e.type){case"String":return this.parseString2(e);case"Num":return this.parseNum2(e);case"hex":return this.parseInteger2(e)}},e}();var s=function(e,t){void 0===t&&(t=!0);var r={x:{numType:"number",value:0},y:{numType:"number",value:0},zIndex:0,scale:{numType:"number",value:1},duration:void 0},a={content:"请输入内容",alpha:{numType:"number",value:1},color:16777215,anchorX:{numType:"number",value:0},anchorY:{numType:"number",value:0},fontSize:{numType:"number",value:25},fontFamily:"SimHei",bold:1,textShadow:1,strokeWidth:0,strokeColor:16777215,rotateX:{numType:"number",value:0},rotateY:{numType:"number",value:0},rotateZ:{numType:"number",value:0},parent:void 0},s={text:"请输入内容",fontSize:{numType:"number",value:25},textColor:0,textAlpha:{numType:"number",value:1},fillColor:16777215,fillAlpha:{numType:"number",value:1},target:void 0},n={d:void 0,viewBox:void 0,borderColor:0,borderAlpha:{numType:"number",value:1},borderWidth:{numType:"number",\nvalue:0},fillColor:16777215,fillAlpha:{numType:"number",value:1}};try{var i=new f(m.parse(e),t).transform(),p={};p.defs=i.defs;for(var o=0;o<i.defs.length;o++)p.defs[o].attrs=u(r,i.defs[o].attrs),"DefText"===p.defs[o].type?p.defs[o].attrs=u(a,i.defs[o].attrs):"DefButton"===p.defs[o].type?p.defs[o].attrs=u(s,i.defs[o].attrs):"DefPath"===p.defs[o].type&&(p.defs[o].attrs=u(n,i.defs[o].attrs));return p.sets=i.sets,p}catch(e){throw new Error(e.message)}},n=self;n.addEventListener("message",function(e){var t=e.data;try{var r=s(t.text);t.defs=r.defs,t.sets=r.sets,n.postMessage(t)}catch(e){console.warn("Error in BAS parser: ",e),n.postMessage({error:e.message})}})}]);'
,null)}},function(e,t,r){var a=r(2);"string"==typeof a&&(a=[[e.i,a,""]]);var s={attrs:{"data-injector":"bilibili-player"},hmr:!0,transform:void 0,insertInto:void 0};r(4)(a,s);a.locals&&(e.exports=a.locals)},function(e,t,r){(e.exports=r(3)(!1)).push([e.i,".bas-danmaku{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);left:50%;top:50%;box-sizing:border-box;width:100%;height:100%;background:transparent;z-index:10}.bas-danmaku.bas-danmaku-pause .bas-danmaku-item{-webkit-animation-play-state:paused;animation-play-state:paused}.bas-danmaku>canvas{pointer-events:auto}.bas-danmaku-item{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards;line-height:1;-webkit-transform-origin:0 0;transform-origin:0 0}.bas-danmaku-item .bas-danmaku-item{position:absolute;left:0;top:0}.bas-danmaku-item.bas-danmaku-item-button{pointer-events:auto;padding:10px 20px;border-radius:3px}.bas-danmaku-item-wrap{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;left:0;right:0;top:0;height:100%;z-index:10}.bas-danmaku-item-inner{border:0;-webkit-transform-origin:0 0;transform-origin:0 0}.bas-danmaku-item-text .bas-danmaku-item-inner{pointer-events:none;border-style:solid}",""])},function(e,t,r){"use strict";e.exports=function(r){var i=[];return i.toString=function(){return this.map(function(e){var t=function(e,t){var r=e[1]||"",a=e[3];if(!a)return r;if(t&&"function"==typeof btoa){var s=(i=a,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */"),n=a.sources.map(function(e){return"/*# sourceURL="+a.sourceRoot+e+" */"});return[r].concat(n).concat([s]).join("\n")}var i;return[r].join("\n")}(e,r);return e[2]?"@media "+e[2]+"{"+t+"}":t}).join("")},i.i=function(e,t){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},a=0;a<this.length;a++){var s=this[a][0];null!=s&&(r[s]=!0)}for(a=0;a<e.length;a++){var n=e[a];null!=n[0]&&r[n[0]]||(t&&!n[2]?n[2]=t:t&&(n[2]="("+n[2]+") and ("+t+")"),i.push(n))}},i}},function(e,t,r){var a,s,n,p={},l=(a=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===s&&(s=a.apply(this,arguments)),s}),i=(n={},function(e){if("function"==typeof e)return e();if(void 0===n[e]){var t=function(e){return document.querySelector(e)}.call(this,e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}n[e]=t}return n[e]}),u=null,h=0,o=[],c=r(5);function f(e,t){for(var r=0;r<e.length;r++){var a=e[r],s=p[a.id];if(s){s.refs++;for(var n=0;n<s.parts.length;n++)s.parts[n](a.parts[n]);for(;n<a.parts.length;n++)s.parts.push(v(a.parts[n],t))}else{var i=[];for(n=0;n<a.parts.length;n++)i.push(v(a.parts[n],t));p[a.id]={id:a.id,refs:1,parts:i}}}}function m(e,t){for(var r=[],a={},s=0;s<e.length;s++){var n=e[s],i=t.base?n[0]+t.base:n[0],o={css:n[1],media:n[2],sourceMap:n[3]};a[i]?a[i].parts.push(o):r.push(a[i]={id:i,parts:[o]})}return r}function d(e,t){var r=i(e.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var a=o[o.length-1];if("top"===e.insertAt)a?a.nextSibling?r.insertBefore(t,a.nextSibling):r.appendChild(t):r.insertBefore(t,r.firstChild),o.push(t);else if("bottom"===e.insertAt)r.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var s=i(e.insertInto+" "+e.insertAt.before);r.insertBefore(t,s)}}function b(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=o.indexOf(e);0<=t&&o.splice(t,1)}function g(e){
var t=document.createElement("style");return void 0===e.attrs.type&&(e.attrs.type="text/css"),y(t,e.attrs),d(e,t),t}function y(t,r){Object.keys(r).forEach(function(e){t.setAttribute(e,r[e])})}function v(t,e){var r,a,s,n,i,o;if(e.transform&&t.css){if(!(n=e.transform(t.css)))return function(){};t.css=n}if(e.singleton){var p=h++;r=u||(u=g(e)),a=w.bind(null,r,p,!1),s=w.bind(null,r,p,!0)}else s=t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=e,o=document.createElement("link"),void 0===i.attrs.type&&(i.attrs.type="text/css"),i.attrs.rel="stylesheet",y(o,i.attrs),d(i,o),a=function(e,t,r){var a=r.css,s=r.sourceMap,n=void 0===t.convertToAbsoluteUrls&&s;(t.convertToAbsoluteUrls||n)&&(a=c(a));s&&(a+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */");var i=new Blob([a],{type:"text/css"}),o=e.href;e.href=URL.createObjectURL(i),o&&URL.revokeObjectURL(o)}.bind(null,r=o,e),function(){b(r),r.href&&URL.revokeObjectURL(r.href)}):(r=g(e),a=function(e,t){var r=t.css,a=t.media;a&&e.setAttribute("media",a);if(e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}.bind(null,r),function(){b(r)});return a(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;a(t=e)}else s()}}e.exports=function(e,i){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(i=i||{}).attrs="object"==typeof i.attrs?i.attrs:{},i.singleton||"boolean"==typeof i.singleton||(i.singleton=l()),i.insertInto||(i.insertInto="head"),i.insertAt||(i.insertAt="bottom");var o=m(e,i);return f(o,i),function(e){for(var t=[],r=0;r<o.length;r++){var a=o[r];(s=p[a.id]).refs--,t.push(s)}e&&f(m(e,i),i);for(r=0;r<t.length;r++){var s;if(0===(s=t[r]).refs){for(var n=0;n<s.parts.length;n++)s.parts[n]();delete p[s.id]}}}};var k,x=(k=[],function(e,t){return k[e]=t,k.filter(Boolean).join("\n")});function w(e,t,r,a){var s=r?"":a.css;if(e.styleSheet)e.styleSheet.cssText=x(t,s);else{var n=document.createTextNode(s),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(n,i[t]):e.appendChild(n)}}},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var s=t.protocol+"//"+t.host,n=s+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var r,a=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(a)?e:(r=0===a.indexOf("//")?a:0===a.indexOf("/")?s+a:n+a.replace(/^\.\//,""),"url("+JSON.stringify(r)+")")})}},function(e,t,r){"use strict";var s=window.URL||window.webkitURL;e.exports=function(t,r){try{try{var a;try{(a=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder)).append(t),a=a.getBlob()}catch(e){a=new Blob([t])}return new Worker(s.createObjectURL(a))}catch(e){return new Worker("data:application/javascript,"+encodeURIComponent(t))}}catch(e){if(!r)throw Error("Inline worker is not supported");return new Worker(r)}}},function(e,t,r){"use strict";r.r(t);r(1);var y={extend:function(e,t){var r={};for(var a in e)e.hasOwnProperty(a)&&(r[a]=e[a]);for(var a in t)t.hasOwnProperty(a)&&(r[a]=t[a]);return r},escapeSpecialChars:function(e){return e.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t").replace(/\f/g,"\\f")},nowTime:function(){return performance?performance.now():+new Date},string2DOM:function(e){return $(e)[0]},colorFromInt:function(e){return"#"+("00000"+e.toString(16)).slice(-6)},rgbaFormat:function(e,t){var r=("00000"+e.toString(16)).slice(-6);return"rgba("+parseInt(r.slice(0,2),16)+","+parseInt(r.slice(2,4),16)+","+parseInt(r.slice(4,6),16)+","+t+")"},
htmlEncode:function(e,t,r){return r||(e=e.replace(/&/g,"").replace(/</g,"").replace(/>/g,"").replace(/"/g,"").replace(/'/g,"").replace(/\//g,"").replace(/:/g,"").replace(/;/g,"")),e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2f;").replace(/ /g,t?" ":"&nbsp;").replace(/\n/g,"<br>")},browser:{get version(){var e=navigator.userAgent.toLowerCase(),t=/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.test(e)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.test(e),r=/(chrome)[ \/]([\w.]+)/.exec(e)||"",a={browser:r[5]||r[3]||r[1]||"",version:r[4]||r[2]||"0"},s=0;return a.browser&&(s=parseInt(a.version,10)),{browser:a.browser,version:s,linux:/Linux/i.test(e),webKit:/AppleWebKit/i.test(e),gecko:/Gecko/i.test(e)&&!/KHTML/i.test(e),trident:/Trident/i.test(e),presto:/Presto/i.test(e),mobile:/AppleWebKit.*Mobile.*/i.test(e),iOS:/Mac OS X[\s_\-\/](\d+[.\-_]\d+[.\-_]?\d*)/i.test(e),iPhone:/iPhone/i.test(e),iPad:/iPad/i.test(e),webApp:!/Safari/i.test(e),android:/Android/i.test(e),windowsPhone:/Windows Phone/i.test(e),microMessenger:/MicroMessenger/i.test(e),msie:/msie [\w.]+/i.test(e),edge:/edge/i.test(e),edgeBuild16299:/(\s|^)edge\/16.16299(\s|$)/i.test(e),safari:t,safariSupportMSE:t&&/Version\/1\d/i.test(e)}}}},i=function(){function e(e){this.prefix=["","-webkit-"],this.endProgress={},this.xProportion=e.container.offsetWidth/100,this.yProportion=e.container.offsetHeight/100,this.container=e.container,this.dm=e.dm,this.percentObj2Num(this.dm),this.defs=this.dm.defs,this.sets=this.dm.sets,this.startTime=e.startTime,this.player=e.player,this.animationEndCallback=e.animationEndCallback,this.init()}return e.prototype.init=function(){var e=this.itemsTemplate();if(e){var t=100*this.xProportion/2/Math.tan(Math.PI/180*27.5);this.ele=y.string2DOM('<div class="bas-danmaku-item-wrap" style="perspective:'+t+"px;-webkit-perspective:"+t+'px;">'+this.animationTemplate()+e+"</div>");for(var r=0;r<this.defs.length;r++){var a=this.defs[r].name;this.endProgress[a]=0,this.transience(a)}this.bindEvents(this.ele)}},e.prototype.animationCallback=function(e){var t=e.animationName.split("-")[2];this.endProgress[t]?this.endProgress[t]++:this.endProgress[t]=1,this.transience(t),this.animationEndCallback(this),this.endProgress[t]!==this.dm.def2set[t].length&&"duration"!==e.animationName.split("-")[3]||(e.target.parentNode.removeChild(e.target),0===this.ele.getElementsByClassName("bas-danmaku-item").length&&this.container.removeChild(this.ele))},e.prototype.transience=function(e){var t=this.endProgress[e],r=this.dm.def2set[e][t];if(r&&r.valueEnd&&(r.valueEnd.content&&(this.ele.querySelector(".bas-danmaku-item--"+e+" .bas-danmaku-item-inner").innerHTML=r.valueEnd.content.value),r.valueEnd.text&&(this.ele.querySelector(".bas-danmaku-item--"+e+" .bas-danmaku-item-inner").innerHTML=r.valueEnd.text.value),r.valueEnd.fontSize)){var a=r.valueEnd.fontSize.value;12<=a?this.ele.querySelector(".bas-danmaku-item--"+e+" .bas-danmaku-item-inner").style.fontSize=a+"px":(this.ele.querySelector(".bas-danmaku-item--"+e+" .bas-danmaku-item-inner").style.fontSize="12px",this.ele.querySelector(".bas-danmaku-item--"+e+" .bas-danmaku-item-inner").style.transform="scale("+a/12+")")}},e.prototype.percentObj2Num=function(e){for(var a=this,t=function(e){for(var t in e)if(e.hasOwnProperty(t)){var r=void 0;if(e[t].numType)r=e[t];else{if(!e[t].value||!e[t].value.numType)continue;r=e[t].value}if("number"===r.numType)switch(t){case"x":r=r.value/a.xProportion;break;case"y":r=r.value/a.yProportion;break;default:r=r.value}else if("percent"===r.numType)switch(t){case"fontSize":case"width":r=r.value*a.xProportion;break;case"height":r=r.value*a.yProportion;break;default:r=r.value}e[t].numType?e[t]=r:e[t].value&&e[t].value.numType&&(e[t].value=r)}},r=0;r<e.defs.length;r++)t(e.defs[r].attrs);for(r=0;r<e.sets.length;r++)if(e.sets[r].items)for(var s=0;s<e.sets[r].items.length;s++)t(e.sets[r].items[s].attrs);else t(e.sets[r].attrs);for(var n in e.def2set)if({}.hasOwnProperty.call(e.def2set
,n))for(r=0;r<e.def2set[n].length;r++)t(e.def2set[n][r].valueEnd),t(e.def2set[n][r].valueStart)},e.prototype.itemsTemplate=function(){for(var e="",t=0;t<this.defs.length;t++)this.defs[t].attrs.parent||(e+=this.itemsTemplateOne(this.defs[t]));return e},e.prototype.itemsTemplateOne=function(e,t,r){var s=this;void 0===t&&(t=this.xProportion),void 0===r&&(r=this.yProportion);var a,n=function(e,t){for(var r="",a=0;a<e.length;a++)r+="duration"===t?e[a][t]+"s":"delay"===t?e[a][t]-s.startTime+"s":e[a][t],a!==e.length-1&&(r+=",");return r},i=e.attrs,o=this.dm.def2set[e.name],p=""+this.prefixCSS("animation-name",n(o,"name"))+this.prefixCSS("animation-duration",n(o,"duration"))+this.prefixCSS("animation-timing-function",n(o,"easing"))+this.prefixCSS("animation-delay",n(o,"delay"));for(var l in i)i.hasOwnProperty(l)&&(p+=this.getStyleOut(l,i[l]));switch(e.type){case"DefText":var u="";(i.rotateX||i.rotateY||i.rotateZ)&&(u=" rotateX("+i.rotateX+"deg) rotateY("+i.rotateY+"deg) rotateZ("+i.rotateZ+"deg)"),p+="transform:translate("+i.x*t+"px, "+i.y*r+"px)"+u+" scale("+i.scale+");",a=this.getStyleIn(i);var h="";for(l=0;l<this.defs.length;l++)this.defs[l].attrs.parent===e.name&&(this.defSize(e),h+=this.itemsTemplateOne(this.defs[l],e.attrs.width/100,e.attrs.height/100));return'<div class="bas-danmaku-item bas-danmaku-item-text bas-danmaku-item--'+e.name+'" style="'+p+'"><div class="bas-danmaku-item-inner" style="'+a+'">'+i.content+h+"</div></div>";case"DefButton":return p+="transform:translate("+i.x*t+"px, "+i.y*r+"px) scale("+i.scale+");color:"+y.rgbaFormat(i.textColor,i.textAlpha)+";background-color:"+y.rgbaFormat(i.fillColor,i.fillAlpha)+";",a=this.getStyleIn(i),'<div class="bas-danmaku-item bas-danmaku-item-button bas-danmaku-item--'+e.name+'" style="'+p+'"><div class="bas-danmaku-item-inner" style="'+a+'">'+i.text+"</div></div>";case"DefPath":p+="transform:translate("+i.x*t+"px, "+i.y*r+"px);",a=this.getStyleIn(i);var c=void 0;i.viewBox?c=i.width||i.height?'viewBox="'+i.viewBox+'" '+(i.width?'width="'+i.width*(i.scale||1)+'"':"")+" "+(i.height?'height="'+i.height*(i.scale||1)+'"':""):'viewBox="'+i.viewBox+'" width="'+parseInt(i.viewBox.split(" ")[2],10)*(i.scale||1)+'"':i.scale&&(c='style="transform:scale('+i.scale+');transform-origin: 0 0;overflow:visible;"');var f='fill="'+y.rgbaFormat(i.fillColor,i.fillAlpha)+'" stroke="'+y.rgbaFormat(i.borderColor,i.borderAlpha)+'" stroke-width="'+i.borderWidth+'" d="'+i.d+'"';return'<div class="bas-danmaku-item bas-danmaku-item-path bas-danmaku-item--'+e.name+'" style="'+p+'"><div class="bas-danmaku-item-inner" style="'+a+'"><svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg" '+c+"><path "+f+"></svg></div></div>"}},e.prototype.findParent=function(e){for(var t=0;t<this.defs.length;t++)if(this.defs[t].name===e)return this.defs[t];return null},e.prototype.defSize=function(e){!e||e.attrs.width&&e.attrs.height||(this.measureCanvas||(this.measureCanvas=document.createElement("canvas").getContext("2d")),this.measureCanvas.font=(e.attrs.bold?"bold ":"")+" "+e.attrs.fontSize+"px "+e.attrs.fontFamily,e.attrs.width=this.measureCanvas.measureText(e.attrs.content).width,e.attrs.height=e.attrs.fontSize)},e.prototype.getStyleIn=function(e){var t="",r="";return e.strokeWidth&&e.strokeColor&&(t+="-webkit-text-stroke:"+e.strokeWidth+"px "+y.colorFromInt(e.strokeColor)+";"),e.hasOwnProperty("fontFamily")&&(t+="font-family:&quot;"+e.fontFamily.split(",").join("&quot;,&quot;")+"&quot;,sans-serif;"),e.hasOwnProperty("textShadow")&&(t+="text-shadow:"+(e.textShadow?"rgb(0, 0, 0) 1px 0px 1px, rgb(0, 0, 0) 0px 1px 1px, rgb(0, 0, 0) 0px -1px 1px, rgb(0, 0, 0) -1px 0px 1px":"none")+";"),e.hasOwnProperty("bold")&&(t+="font-weight:"+(e.bold?"bold":"normal")+";"),e.hasOwnProperty("fontSize")&&(12<=e.fontSize?t+="font-size:"+e.fontSize+"px;":(t+="font-size:12px;",r+="scale("+e.fontSize/12+") ")),e.hasOwnProperty("anchorX")&&e.hasOwnProperty("anchorY")&&(r+="translate("+100*-e.anchorX+"%,"+100*-e.anchorY+"%)"),r&&(t+="transform:"+r+";"),t},e.prototype.getStyleOut=function(e,t){switch(e){case"alpha":
return"opacity:"+t+";";case"color":return"color:"+y.colorFromInt(t)+";";case"zIndex":return"z-index:"+t+";";default:return""}},e.prototype.animationTemplate=function(){for(var e="",t=0;t<this.defs.length;t++)for(var r=this.dm.def2set[this.defs[t].name],a=0;a<r.length;a++)if(this.defs[t].attrs.parent){var s=this.findParent(this.defs[t].attrs.parent);s&&(this.defSize(s),e+=this.keyframesTemplate(this.defs[t],r[a].name,r[a].valueStart,r[a].valueEnd,s.attrs.width/100,s.attrs.height/100))}else e+=this.keyframesTemplate(this.defs[t],r[a].name,r[a].valueStart,r[a].valueEnd);return"<style>"+e+"</style>"},e.prototype.keyframesTemplate=function(t,e,r,a,s,n){void 0===s&&(s=this.xProportion),void 0===n&&(n=this.yProportion);var i="",o="";if(r&&(void 0!==r.x||void 0!==r.y||void 0!==r.rotateX||void 0!==r.rotateY||void 0!==r.rotateZ||void 0!==r.scale)||a&&(void 0!==a.x||void 0!==a.y||void 0!==a.rotateX||void 0!==a.rotateY||void 0!==a.rotateZ||void 0!==a.scale)){var p=function(e){return a&&void 0!==a[e]?a[e].value:r&&void 0!==r[e]?r[e].value:t.attrs[e]?t.attrs[e]:0},l=p("x")*s,u=p("y")*n,h=p("rotateX"),c=p("rotateY"),f=p("rotateZ"),m="DefPath"===t.type?1:p("scale"),d=function(e){return r&&r[e]?r[e].value:t.attrs[e]?t.attrs[e]:0},b=d("x")*s,g=d("y")*n,y=d("rotateX"),v=d("rotateY"),k=d("rotateZ"),x="DefPath"===t.type?1:d("scale");switch(t.type){case"DefText":i+="transform:translate("+b+"px, "+g+"px) rotateX("+y+"deg) rotateY("+v+"deg) rotateZ("+k+"deg) scale("+x+");",o+="transform:translate("+l+"px, "+u+"px) rotateX("+h+"deg) rotateY("+c+"deg) rotateZ("+f+"deg) scale("+m+");";break;case"DefButton":case"DefPath":i+="transform:translate("+b+"px, "+g+"px);",o+="transform:translate("+l+"px, "+u+"px);"}}for(var w in r)r.hasOwnProperty(w)&&(i+=this.getStyleOut(w,r[w].value));for(var w in a)a.hasOwnProperty(w)&&(o+=this.getStyleOut(w,a[w].value));return o||(o="line-height:1;"),i?"\n@-webkit-keyframes "+e+" {\n    0% { "+i+" }\n    100% { "+o+" }\n}\n@keyframes "+e+" {\n    0% { "+i+" }\n    100% { "+o+" }\n}":"\n@-webkit-keyframes "+e+" {\n    100% { "+o+" }\n}\n@keyframes "+e+" {\n    100% { "+o+" }\n}"},e.prototype.prefixCSS=function(e,t){for(var r="",a=0;a<this.prefix.length;a++)r+=""+this.prefix[a]+e+":"+t+";";return r},e.prototype.bindEvents=function(t){var r=this;t.addEventListener("animationend",function(e){return r.animationCallback(e)}),t.addEventListener("webkitAnimationEnd",function(e){return r.animationCallback(e)});for(var e=function(e){a.defs[e].attrs.target&&t.getElementsByClassName("bas-danmaku-item--"+a.defs[e].name)[0].addEventListener("click",function(){"av"===r.defs[e].attrs.target.objType?(window.open("//www.bilibili.com/video/av"+r.defs[e].attrs.target.av+"/index_"+r.defs[e].attrs.target.page+".html"+(r.defs[e].attrs.target.time?"?t="+r.defs[e].attrs.target.time/1e3:"")),r.player&&r.player.pause()):"bangumi"===r.defs[e].attrs.target.objType?(window.open("//www.bilibili.com/bangumi/play/ss"+r.defs[e].attrs.target.seasonId+(r.defs[e].attrs.target.time?"?t="+r.defs[e].attrs.target.time/1e3:"")+"#"+r.defs[e].attrs.target.episodeId),r.player&&r.player.pause()):"seek"===r.defs[e].attrs.target.objType&&r.player&&r.player.seek(r.defs[e].attrs.target.time/1e3)})},a=this,s=0;s<this.defs.length;s++)e(s)},e.prototype.destroy=function(){},e}(),l=function(e,t){var r={};for(var a in e)e.hasOwnProperty(a)&&(r[a]=e[a]);for(var a in t)t.hasOwnProperty(a)&&(r[a]=t[a]);return r},u=function(e,t,r){return r||(e=e.replace(/&/g,"").replace(/</g,"").replace(/>/g,"").replace(/"/g,"").replace(/'/g,"").replace(/\//g,"").replace(/:/g,"").replace(/;/g,"")),e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2f;").replace(/ /g,t?" ":"&nbsp;").replace(/\n/g,"<br>")},h=4294967295,c=4294967295,a=function(){function s(){this.transTable=[[!1,[4294967295,2,1],[[0,35,0],[36,36,1],[37,37,2]]],[!1,[4294967295,20,23,22,21,12,19,18,17,16,15,14,13,11,10,9,8,7,6,5,4,3],[[0,2,0],[3,3,1],[4,4,2],[5,5,3],[6,6,4],[7,7,5],[8,8,6],[9,9,7],[10,10,8],[11,11,9],[12,12,10],[13,13,11],[14,14,12],[15,
15,13],[16,16,14],[17,17,15],[18,18,16],[19,30,17],[31,31,18],[32,32,19],[33,34,20],[35,35,21],[36,37,0]]],[!1,[26,24,25,4294967295],[[0,0,0],[1,16,1],[17,17,2],[18,32,1],[33,33,3],[34,35,1],[36,37,3]]],[!1,[4294967295,27],[[0,34,0],[35,35,1],[36,37,0]]],[!1,[4294967295,4],[[0,32,0],[33,34,1],[35,37,0]]],[!1,[4294967295,33,13,31,30,29,32,28],[[0,6,0],[7,7,1],[8,13,0],[14,14,2],[15,24,0],[25,26,3],[27,27,4],[28,29,5],[30,30,6],[31,31,7],[32,32,2],[33,37,0]]],[!1,[4294967295,34],[[0,13,0],[14,14,1],[15,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,7],[[0,6,0],[7,7,1],[8,10,0],[11,11,1],[12,12,0],[13,14,1],[15,18,0],[19,30,1],[31,31,0],[32,32,1],[33,37,0]]],[!0],[!0],[!0],[!0],[!1,[4294967295,7,35],[[0,6,0],[7,7,1],[8,10,0],[11,11,1],[12,12,0],[13,14,1],[15,18,0],[19,27,1],[28,28,2],[29,30,1],[31,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,33,13,30,29,32,28],[[0,6,0],[7,7,1],[8,13,0],[14,14,2],[15,26,0],[27,27,3],[28,29,4],[30,30,5],[31,31,6],[32,32,2],[33,37,0]]],[!1,[4294967295,7,36],[[0,6,0],[7,7,1],[8,10,0],[11,11,1],[12,12,0],[13,14,1],[15,18,0],[19,29,1],[30,30,2],[31,31,0],[32,32,1],[33,37,0]]],[!0],[!1,[4294967295,7,37],[[0,6,0],[7,7,1],[8,10,0],[11,11,1],[12,12,0],[13,14,1],[15,18,0],[19,27,1],[28,28,2],[29,30,1],[31,31,0],[32,32,1],[33,37,0]]],[!0],[!0],[!0],[!0],[!0],[!0],[!0],[!0],[!0],[!1,[38,4294967295,40,39],[[0,0,0],[1,1,1],[2,2,0],[3,12,1],[13,13,0],[14,16,1],[17,17,0],[18,21,1],[22,23,0],[24,24,2],[25,25,1],[26,26,3],[27,37,1]]],[!1,[27,41,4294967295],[[0,32,0],[33,33,1],[34,35,0],[36,37,2]]],[!1,[4294967295,34],[[0,13,0],[14,14,1],[15,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,42,43],[[0,13,0],[14,14,1],[15,15,0],[16,16,2],[17,17,0],[18,18,2],[19,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,46,44,45],[[0,6,0],[7,7,1],[8,13,0],[14,14,2],[15,30,0],[31,31,3],[32,32,2],[33,37,0]]],[!1,[4294967295,47],[[0,10,0],[11,11,1],[12,13,0],[14,14,1],[15,19,0],[20,21,1],[22,27,0],[28,29,1],[30,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,48,49],[[0,13,0],[14,14,1],[15,30,0],[31,31,2],[32,32,1],[33,37,0]]],[!1,[4294967295,50,51],[[0,13,0],[14,14,1],[15,30,0],[31,31,2],[32,32,1],[33,37,0]]],[!1,[4294967295,33,34,30,29,32],[[0,6,0],[7,7,1],[8,13,0],[14,14,2],[15,26,0],[27,27,3],[28,29,4],[30,30,5],[31,31,0],[32,32,2],[33,37,0]]],[!1,[4294967295,7,52],[[0,6,0],[7,7,1],[8,10,0],[11,11,1],[12,12,0],[13,13,2],[14,14,1],[15,18,0],[19,30,1],[31,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,7,53],[[0,6,0],[7,7,1],[8,10,0],[11,11,1],[12,12,0],[13,14,1],[15,18,0],[19,27,1],[28,28,2],[29,30,1],[31,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,7,54],[[0,6,0],[7,7,1],[8,10,0],[11,11,1],[12,12,0],[13,14,1],[15,18,0],[19,20,1],[21,21,2],[22,30,1],[31,31,0],[32,32,1],[33,37,0]]],[!0],[!1,[4294967295,55],[[0,10,0],[11,11,1],[12,13,0],[14,14,1],[15,19,0],[20,21,1],[22,27,0],[28,29,1],[30,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,56],[[0,10,0],[11,11,1],[12,13,0],[14,14,1],[15,19,0],[20,21,1],[22,27,0],[28,29,1],[30,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,41],[[0,32,0],[33,33,1],[34,37,0]]],[!1,[4294967295,33,42,30,32],[[0,6,0],[7,7,1],[8,13,0],[14,14,2],[15,26,0],[27,27,3],[28,29,0],[30,30,4],[31,31,0],[32,32,2],[33,37,0]]],[!1,[4294967295,42],[[0,13,0],[14,14,1],[15,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,33,44,58,57,45],[[0,6,0],[7,7,1],[8,13,0],[14,14,2],[15,26,0],[27,27,3],[28,29,4],[30,30,0],[31,31,5],[32,32,2],[33,37,0]]],[!1,[4294967295,59],[[0,13,0],[14,14,1],[15,31,0],[32,32,1],[33,37,0]]],[!0],[!1,[4294967295,47],[[0,10,0],[11,11,1],[12,13,0],[14,14,1],[15,19,0],[20,21,1],[22,27,0],[28,29,1],[30,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,33,48,30,60,49],[[0,6,0],[7,7,1],[8,13,0],[14,14,2],[15,26,0],[27,27,3],[28,29,4],[30,30,0],[31,31,5],[32,32,2],[33,37,0]]],[!1,[4294967295,61],[[0,13,0],[14,14,1],[15,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,50,58,62,51],[[0,13,0],[14,14,1],[15,26,0],[27,27,2],[28,29,3],[30,30,0],[31,31,4],[32,32,1],[33,37,0]]],[!1,[4294967295,63],[[0,13,0],[14,14,1],[15,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,7],[[0,6,0],[7,7,1],[8,10,0],[11,11,1],[12,12,0],[13,14,1],[15,18,0],[19,30,1],[31,31,0],[32
,32,1],[33,37,0]]],[!1,[4294967295,7,64],[[0,6,0],[7,7,1],[8,10,0],[11,11,1],[12,12,0],[13,14,1],[15,18,0],[19,22,1],[23,23,2],[24,30,1],[31,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,7],[[0,6,0],[7,7,1],[8,10,0],[11,11,1],[12,12,0],[13,14,1],[15,18,0],[19,30,1],[31,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,65],[[0,10,0],[11,11,1],[12,13,0],[14,14,1],[15,19,0],[20,21,1],[22,27,0],[28,29,1],[30,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,66],[[0,10,0],[11,11,1],[12,13,0],[14,14,1],[15,19,0],[20,21,1],[22,27,0],[28,29,1],[30,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,67,68],[[0,13,0],[14,14,1],[15,15,0],[16,16,2],[17,17,0],[18,18,2],[19,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,46],[[0,6,0],[7,7,1],[8,37,0]]],[!1,[4294967295,33,59,58,57],[[0,6,0],[7,7,1],[8,13,0],[14,14,2],[15,26,0],[27,27,3],[28,29,4],[30,31,0],[32,32,2],[33,37,0]]],[!1,[4294967295,69,70],[[0,13,0],[14,14,1],[15,15,0],[16,16,2],[17,17,0],[18,18,2],[19,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,33,61,30,60],[[0,6,0],[7,7,1],[8,13,0],[14,14,2],[15,26,0],[27,27,3],[28,29,4],[30,31,0],[32,32,2],[33,37,0]]],[!1,[4294967295,71,72],[[0,13,0],[14,14,1],[15,15,0],[16,16,2],[17,17,0],[18,18,2],[19,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,63,58,62],[[0,13,0],[14,14,1],[15,26,0],[27,27,2],[28,29,3],[30,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,7],[[0,6,0],[7,7,1],[8,10,0],[11,11,1],[12,12,0],[13,14,1],[15,18,0],[19,30,1],[31,31,0],[32,32,1],[33,37,0]]],[!0],[!1,[4294967295,73],[[0,10,0],[11,11,1],[12,13,0],[14,14,1],[15,19,0],[20,21,1],[22,27,0],[28,29,1],[30,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,33,67,58],[[0,6,0],[7,7,1],[8,13,0],[14,14,2],[15,26,0],[27,27,3],[28,31,0],[32,32,2],[33,37,0]]],[!1,[4294967295,67],[[0,13,0],[14,14,1],[15,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,33,69,30],[[0,6,0],[7,7,1],[8,13,0],[14,14,2],[15,26,0],[27,27,3],[28,31,0],[32,32,2],[33,37,0]]],[!1,[4294967295,69],[[0,13,0],[14,14,1],[15,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,71,58],[[0,13,0],[14,14,1],[15,26,0],[27,27,2],[28,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,71],[[0,13,0],[14,14,1],[15,31,0],[32,32,1],[33,37,0]]],[!1,[4294967295,74],[[0,10,0],[11,11,1],[12,13,0],[14,14,1],[15,19,0],[20,21,1],[22,27,0],[28,29,1],[30,31,0],[32,32,1],[33,37,0]]],[!0]],this.finalTable={64:15,65:10,4:1,5:3,6:23,7:26,8:5,9:7,10:6,11:24,12:26,13:3,14:26,15:21,16:26,17:16,18:19,19:20,20:25,21:17,22:18,23:22,24:12,25:11,74:9,30:2,32:2,33:2,34:3,35:26,36:26,37:26,38:8,41:0,42:3,27:0,46:2,47:4,52:13,53:26,54:14},this.inputTable=[[0,8,1],[9,9,34],[10,10,33],[11,11,1],[12,12,34],[13,13,33],[14,31,1],[32,32,34],[33,33,1],[34,34,17],[35,35,1],[36,36,19],[37,37,3],[38,38,1],[39,39,2],[40,40,6],[41,41,5],[42,42,1],[43,43,18],[44,44,15],[45,45,16],[46,46,31],[47,47,35],[48,48,32],[49,57,14],[58,60,1],[61,61,10],[62,63,1],[64,64,19],[65,68,20],[69,69,29],[70,70,20],[71,87,19],[88,88,25],[89,90,19],[91,91,9],[92,92,0],[93,93,8],[94,94,1],[95,95,19],[96,96,1],[97,99,20],[100,100,11],[101,101,28],[102,102,21],[103,103,19],[104,104,30],[105,108,19],[109,109,27],[110,110,23],[111,113,19],[114,114,22],[115,115,7],[116,116,13],[117,117,24],[118,119,19],[120,120,26],[121,122,19],[123,123,12],[124,124,1],[125,125,4],[126,65535,1]],this.initialTable={INITIAL:2,STRING:1}}return s.lexSeq=function(e){var t=new s;t.source=e;for(var r=[],a=t.token;"<$>"!==a;)r.push({token:a,text:t.yytext,start:t.startIdx,end:t.endIdx}),t.advance(),a=t.token;return r},s.prototype.yyrestart=function(e){void 0===e&&(e=null),null!=e&&(this.sourceString=e),this.ended=!1,this.start=0,this.oldStart=0,this.line=1,this.col=0,this.advanced=!0,this.tokenNameString=null,this.yyObject={},this.initialState="INITIAL"},Object.defineProperty(s.prototype,"source",{set:function(e){this.sourceString=e,this.yyrestart()},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"token",{get:function(){return this.advanced&&(this.tokenNameString=this.next(),this.advanced=!1),this.tokenNameString},enumerable:!0,configurable:!0}),s.prototype.advance=function(){this.advanced=!0},Object.defineProperty(s.prototype,"startIdx",{get:function(
){return this.oldStart},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"endIdx",{get:function(){return this.start},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"position",{get:function(){return[this.line,this.col]},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"positionInfo",{get:function(){return this.token+"@row:"+this.position.join("col:")},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"yytext",{get:function(){return this.yyText},set:function(e){this.yyText=e},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"yyleng",{get:function(){return this.endIdx-this.startIdx},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"yy",{get:function(){return this.yyObject},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"tokenName",{get:function(){return this.tokenNameString},enumerable:!0,configurable:!0}),s.prototype.next=function(){for(var e,t,r,a,s,n,i,o,p;;)for(t=e=null,r=0,a=this.start,s=this.start,n=c,o=h,p=this.start,i=this.transTable[0][1][this.initialInput];;){if(r=this.sourceString.charCodeAt(s),n!==c&&(13===r?(this.col=0,this.line++):10===r?13!==n&&(this.col=0,this.line++):this.col++),n=r,(t=this.trans(i,r))===h){if(a===p){if(this.start!==this.sourceString.length)throw new Error("意外的字符,line:"+this.position.join(",col:")+"of "+this.sourceString.substr(a,20));if(!1===this.ended)return this.ended=!0,"<$>";throw new Error("已经到达末尾.")}switch(e=this.finalTable[o],this.start=p,this.oldStart=a,this.yyText=this.sourceString.substring(this.startIdx,this.endIdx),e){case 2:return"time";case 3:return"number";case 4:return"hex";case 5:return"+";case 6:return"-";case 7:return this.begin("STRING"),"str_start";case 8:return"str_esc_char";case 9:return"str_esc_unicode";case 10:return"str_esc_ascii";case 11:return this.begin("INITIAL"),"str_end";case 12:return"str_seg";case 13:return"set";case 14:return"def";case 15:return"then";case 16:return"=";case 17:return"(";case 18:return")";case 19:return"[";case 20:return"]";case 21:return"{";case 22:return"}";case 23:return".";case 24:return",";case 25:return"%";case 26:return"id"}break}null!=(e=this.finalTable[t])&&(o=t,p=s+1),s+=1,i=t}},s.prototype.trans=function(e,t){if(isNaN(t))return h;if(t<this.inputTable[0][0]||t>this.inputTable[this.inputTable.length-1][1])throw new Error("输入超出有效范围,line:"+this.position.join(",col:"));if(!0===this.transTable[e][0])return h;var r=this.find(t,this.inputTable),a=this.find(r,this.transTable[e][2]);return this.transTable[e][1][a]},s.prototype.find=function(e,t){var r,a,s;for(r=0,a=t.length-1;;){if(t[s=r+a>>>1][0]<=e&&t[s][1]>=e)return t[s][2];t[s][0]>e?a=s-1:r=s+1}},s.prototype.begin=function(e){void 0===e&&(e=null),this.initialState=null!=e?e:"INITIAL"},Object.defineProperty(s.prototype,"initialState",{get:function(){return this.initialStateString},set:function(e){if(void 0===this.initialTable[e])throw new Error("未定义的起始状态:"+e);this.initialStateString=e,this.initialInput=this.initialTable[e]},enumerable:!0,configurable:!0}),s}(),f=function(){function r(){this.actionTable=[null,{0:6,1:1,2:2,35:14,38:48,7:4,8:8,9:10,10:12,44:44,45:38,46:54,47:52,73:86,70:46,24:42,71:50,27:40},{11:41,20:20,21:22,22:16,28:18},{32:26,19:28,42:24,35:14,29:32,30:30,31:73},{0:6,2:9,81:74,4:29,69:78,6:35,7:4,8:8,9:10,10:12,12:43,70:46,71:50,16:55,64:58,18:43,19:61,78:169,23:58,24:42,72:77,73:86,27:40,66:106,82:102,79:104,33:77,34:58,35:14,36:61,38:48,39:56,41:77,43:99,44:44,45:38,46:54,47:52,49:72,50:70,80:76,55:68,56:60,57:62,58:64,59:66,61:98,62:100},{10:39,3:27,35:14,29:27,30:39},{38:48,71:50,40:37,9:37,44:44,45:38,70:46,73:86,18:45,12:45,14:37,24:42,25:37,27:40},{32:26,35:14,68:159,69:78,73:86,42:24,67:112,44:129,83:110,80:76,49:72,50:70,19:28,84:108,55:68,81:74,59:66,29:32,30:30,31:75},{0:6,70:46,2:11,35:14,5:11,38:48,7:4,8:8,9:10,10:12,44:44,45:38,14:36,15:11,17:11,34:11,71:50,46:54,47:52,24:42,25:34,73:86,27:40},{0:6,2:13,5:13,70:46,7:4,8:8,9:10,10:12,13:49,14:36,15:13,17:13,71:50,25:34,26:71,27:40,24:42,34:13,35:14,73:86,38:48,44:44,45:38,46:54,47:52,
48:131},{64:58,66:106,69:78,70:46,71:50,72:167,73:86,14:36,15:51,80:76,81:74,82:102,23:58,24:42,25:34,27:40,79:104,33:79,34:58,38:48,39:56,40:95,41:97,44:44,45:38,49:72,50:70,55:68,56:60,57:62,58:64,59:66,61:98,62:100},{78:101,43:101,54:101,38:91},{0:6,2:15,35:14,38:48,7:4,8:8,9:10,10:12,44:44,45:38,46:54,47:52,73:86,70:46,24:42,71:50,27:40},{37:89},{78:103,54:103,43:103},{78:84,51:80,52:82,60:141,43:84,54:84},{69:163},{78:105,54:105,43:105},{78:107,54:107,43:107},{78:109,43:109,54:109,63:109},{65:149,74:88,75:90,76:92,53:96,77:94},{65:151,74:88,75:90,76:92,53:96,77:94},{65:153,74:88,75:90,76:92,53:96,77:94},{65:155,74:88,75:90,76:92,53:96,77:94},{65:157,74:88,75:90,76:92,53:96,77:94},{43:111},{67:112,68:161,69:78,73:86,80:76,49:72,50:70,83:110,84:108,54:135,55:68,81:74,59:66}],this.gotoTable={27:{0:5},28:{0:7},29:{2:17},30:{2:19},31:{17:57,2:21,34:83,5:31,15:53},32:{36:63,2:23,19:63},33:{36:25,2:25,19:25},34:{19:65},35:{12:47,18:59},36:{36:87,19:67},37:{5:33},38:{64:147,34:85,23:69},39:{38:93},40:{63:143},41:{78:113,43:113,54:113,63:145},42:{72:81,33:81,41:81},43:{43:115},44:{78:171,54:137,43:117},45:{43:119},46:{78:121,54:121,43:121},47:{78:123,54:123,43:123},48:{69:165},49:{53:133},50:{43:125},51:{43:127},52:{54:139}},this.prodList=[[53,2],[27,1],[28,2],[28,0],[29,1],[29,1],[29,1],[32,4],[33,3],[33,3],[35,1],[35,1],[34,3],[34,1],[34,0],[36,1],[36,1],[37,2],[37,1],[31,6],[31,3],[31,3],[39,1],[39,3],[39,0],[40,1],[30,6],[30,6],[38,2],[38,0],[42,3],[43,1],[43,1],[44,1],[44,1],[44,1],[44,1],[46,3],[48,1],[48,0],[47,1],[47,1],[47,0],[41,3],[49,2],[49,2],[49,2],[49,2],[49,0],[45,1],[45,1],[51,4],[50,3],[50,2],[52,3],[52,3],[52,1]],this.inputTable={"<$>":1,"(":2,")":3,id:4,".":5,then:6,",":7,set:8,"{":9,"}":10,time:11,def:12,"=":13,hex:14,number:15,"%":16,"+":17,"-":18,str_start:19,str_end:20,str_esc_char:21,str_esc_unicode:22,str_esc_ascii:23,str_seg:24,"[":25,"]":26}}return r.parse=function(e){var t=new a;return t.source=e,(new r).parseLexer(t)},r.prototype.parseLexer=function(e){for(var t,r,a,s=[0],n=[];;){if(r=e.token,t=s[s.length-1],null==this.actionTable[this.inputTable[r]][t])throw new Error("Parse Error:"+e.positionInfo);if(1===(a=this.actionTable[this.inputTable[r]][t]))return n.pop();if(1==(1&a))n.push(e.yytext),s.push((a>>>1)-1),e.advance();else if(0==(1&a)){var i=a>>>1,o=this.prodList[i][1],p=null;switch(0<o&&(p=n[n.length-o]),i){case 1:p={type:"GlobalExprs",params:n[n.length-1]};break;case 2:(p=n[n.length-2]).push(n[n.length-1]);break;case 3:p=[];break;case 4:p={type:"DefExpr",params:n[n.length-1]};break;case 5:p={type:"SetExpr",params:n[n.length-1]};break;case 6:p={type:"CallExpr",params:n[n.length-1]};break;case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:break;case 17:(p=n[n.length-2]).push(n[n.length-1]);break;case 18:p=[n[n.length-1]];break;case 19:p={type:"UnitSetExpr",params:[n[n.length-5],n[n.length-3],n[n.length-1]]};break;case 20:p={type:"ThenSetExpr",params:[n[n.length-3],n[n.length-1]]};break;case 21:p={type:"GroupSetExpr",params:n[n.length-2]};break;case 22:p={type:"SetExprParams",params:[n[n.length-1]]};break;case 23:p={type:"SetExprParams",params:[n[n.length-3],n[n.length-1]]};break;case 24:p={type:"SetExprParams",params:[]};break;case 25:break;case 26:p={type:"NormalDefExpr",params:[n[n.length-5],n[n.length-4],n[n.length-2]]};break;case 27:p={type:"TweenDefExpr",params:[n[n.length-5],n[n.length-4],n[n.length-2]]};break;case 28:(p=n[n.length-2]).push(n[n.length-1]);break;case 29:p=[];break;case 30:p={type:"ASetter",params:[n[n.length-3],n[n.length-1]]};break;case 31:p={type:"SimpleValue",value:n[n.length-1]};break;case 32:break;case 33:p={type:"Num",value:n[n.length-1]};break;case 34:break;case 35:p={type:"hex",value:n[n.length-1]};break;case 36:p={type:"time",value:n[n.length-1]};break;case 37:p=[n[n.length-3],n[n.length-2],n[n.length-1]];break;case 38:case 39:case 40:case 41:break;case 42:p="+";break;case 43:p={type:"String",value:n[n.length-2]};break;case 44:(p=n[n.length-2]).push({type:"char",value:n[n.length-1]});break;case 45:(p=n[n.length-2]).push({
type:"unicode",value:n[n.length-1]});break;case 46:(p=n[n.length-2]).push({type:"ascii",value:n[n.length-1]});break;case 47:(p=n[n.length-2]).push({type:"seg",value:n[n.length-1]});break;case 48:p=[];break;case 49:case 50:p={type:"ComplexValue",value:n[n.length-1]};break;case 51:p={type:"Object",params:[n[n.length-4],n[n.length-2]]};break;case 52:p={type:"Array",params:n[n.length-2]};break;case 53:p={type:"Array",params:[]};break;case 54:case 55:(p=n[n.length-3]).push(n[n.length-1]);break;case 56:p=[n[n.length-1]]}for(var l=0;l<o;)s.pop(),n.pop(),l++;if(t=s[s.length-1],null==this.gotoTable[this.prodList[i][0]][t])throw new Error("Goto Error!"+e.positionInfo);a=this.gotoTable[this.prodList[i][0]][t],s.push((a>>>1)-1),n.push(p)}}},r}(),m=function(){function e(e,t){this.ast=e,this.encode=t,this.defTypeInfo={}}return e.prototype.transform=function(){for(var e=[],t=[],r=0,a=this.ast.params;r<a.length;r++){var s=a[r];switch(s.type){case"SetExpr":e.push(this.trans(s.params));break;case"DefExpr":var n=s.params;switch(n.type){case"NormalDefExpr":var i=n.params[0],o=n.params[1];switch(i){case"text":case"button":case"path":this.defTypeInfo[o]=i}t.push(n)}}}return t=t.map(this.transDef.bind(this)).filter(function(e){return null!=e}),{sets:e=e.map(this.transSet.bind(this)).filter(function(e){return null!=e}),defs:t}},e.prototype.trans=function(e){if("ThenSetExpr"!==e.type)return"GroupSetExpr"===e.type?(e.params=e.params.map(this.trans.bind(this)).filter(function(e){return null!=e}),e):"UnitSetExpr"===e.type?e:void 0;var t=this.trans(e.params[0]),r=this.trans(e.params[1]);return"ThenSetExpr"===t.type?(t.params.push(r),t):(e.params=[t,r],e)},e.prototype.transDef=function(e){if("NormalDefExpr"===e.type&&3===e.params.length){var t=e.params[0],r=e.params[1],a=e.params[2];if("text"===t){for(var s={type:"DefText",name:r,attrs:{}},n=0,i=a;n<i.length;n++){var o=i[n];this.transAsetterNV(o,s)}return s}if("button"===t){s={type:"DefButton",name:r,attrs:{}};for(var p=0,l=a;p<l.length;p++){o=l[p];this.transAsetterNV(o,s)}return s}if("path"===t){s={type:"DefPath",name:r,attrs:{}};for(var u=0,h=a;u<h.length;u++){o=h[u];this.transAsetterNV(o,s)}return s}}},e.prototype.transAsetterNV=function(e,t){if("DefText"===t.type){var r=e.params[0];e.params[1];switch(r){case"content":t.attrs.content=this.parseString(e.params[1],!1,!0);break;case"fontFamily":t.attrs.fontFamily=this.parseString(e.params[1],!0);break;case"fontSize":t.attrs.fontSize=this.parseNum(e.params[1]);break;case"x":t.attrs.x=this.parseNum(e.params[1]);break;case"y":t.attrs.y=this.parseNum(e.params[1]);break;case"alpha":t.attrs.alpha=this.parseNum(e.params[1]);break;case"anchorX":t.attrs.anchorX=this.parseNum(e.params[1]);break;case"anchorY":t.attrs.anchorY=this.parseNum(e.params[1]);break;case"color":t.attrs.color=this.parseInteger(e.params[1]);break;case"zIndex":t.attrs.zIndex=this.parseInteger(e.params[1]);break;case"parent":t.attrs.parent=this.parseString(e.params[1]);break;case"bold":t.attrs.bold=this.parseInteger(e.params[1]);break;case"textShadow":t.attrs.textShadow=this.parseInteger(e.params[1]);break;case"strokeWidth":t.attrs.strokeWidth=this.parseInteger(e.params[1]);break;case"strokeColor":t.attrs.strokeColor=this.parseInteger(e.params[1]);break;case"rotateX":t.attrs.rotateX=this.parseNum(e.params[1]);break;case"rotateY":t.attrs.rotateY=this.parseNum(e.params[1]);break;case"rotateZ":t.attrs.rotateZ=this.parseNum(e.params[1]);break;case"scale":t.attrs.scale=this.parseNum(e.params[1]);break;case"duration":t.attrs.duration=this.parseTime(e.params[1])}}else if("DefButton"===t.type){r=e.params[0],e.params[1];switch(r){case"text":t.attrs.text=this.parseString(e.params[1],!1,!0);break;case"fontSize":t.attrs.fontSize=this.parseNum(e.params[1]);break;case"textColor":t.attrs.textColor=this.parseInteger(e.params[1]);break;case"textAlpha":t.attrs.textAlpha=this.parseNum(e.params[1]);break;case"fillColor":t.attrs.fillColor=this.parseInteger(e.params[1]);break;case"fillAlpha":t.attrs.fillAlpha=this.parseNum(e.params[1]);break;case"x":t.attrs.x=this.parseNum(e.params[1]);break;case"y":
t.attrs.y=this.parseNum(e.params[1]);break;case"duration":t.attrs.duration=this.parseTime(e.params[1]);break;case"target":t.attrs.target=this.parseObject(e.params[1]);break;case"zIndex":t.attrs.zIndex=this.parseInteger(e.params[1]);break;case"scale":t.attrs.scale=this.parseNum(e.params[1])}}else if("DefPath"===t.type){r=e.params[0],e.params[1];switch(r){case"d":t.attrs.d=this.parseString(e.params[1],!0);break;case"viewBox":t.attrs.viewBox=this.parseString(e.params[1],!0);break;case"fillColor":t.attrs.fillColor=this.parseInteger(e.params[1]);break;case"fillAlpha":t.attrs.fillAlpha=this.parseNum(e.params[1]);break;case"borderColor":t.attrs.borderColor=this.parseInteger(e.params[1]);break;case"borderAlpha":t.attrs.borderAlpha=this.parseNum(e.params[1]);break;case"borderWidth":t.attrs.borderWidth=this.parseNum(e.params[1]);break;case"x":t.attrs.x=this.parseNum(e.params[1]);break;case"y":t.attrs.y=this.parseNum(e.params[1]);break;case"scale":t.attrs.scale=this.parseNum(e.params[1]);break;case"width":t.attrs.width=this.parseNum(e.params[1]);break;case"height":t.attrs.height=this.parseNum(e.params[1]);break;case"duration":t.attrs.duration=this.parseTime(e.params[1]);break;case"zIndex":t.attrs.zIndex=this.parseInteger(e.params[1])}}},e.prototype.parseString=function(e,t,r){if(void 0===t&&(t=!1),void 0===r&&(r=!1),"SimpleValue"===e.type)return this.parseString2(e.value,t,r)},e.prototype.parseString2=function(e,t,r){if(void 0===t&&(t=!1),void 0===r&&(r=!1),"String"===e.type){for(var a=[],s=0,n=e.value;s<n.length;s++){var i=n[s];switch(i.type){case"char":var o=null;switch(i.value.charAt(1)){case"n":o="\n";break;case"r":o="\r";break;case"t":o="\t";break;case"\\":o="\\";break;case"'":o="'";break;case'"':o='"';break;default:o=i.charAt(1)}a.push(o);break;case"unicode":case"ascii":var p=i.value.substr(2);a.push(String.fromCharCode(parseInt(p,16)));break;case"seg":a.push(i.value)}}return this.encode?u(a.join(""),t,r):a.join("")}},e.prototype.parseNum=function(e){if("SimpleValue"===e.type)return this.parseNum2(e.value)},e.prototype.parseNum2=function(e){if("Num"===e.type){var t="+"===e.value[0]?1:-1,r=e.value[1];return{numType:"%"===e.value[2]?"percent":"number",value:t*parseFloat(r)}}},e.prototype.parseInteger=function(e){if("SimpleValue"===e.type)return this.parseInteger2(e.value)},e.prototype.parseInteger2=function(e){return"hex"===e.type?parseInt(e.value.substr(2),16):"Num"===e.type?Math.floor(this.parseNum2(e).value):void 0},e.prototype.transSet=function(e){if("ThenSetExpr"===e.type||"GroupSetExpr"===e.type){var t=e.params.map(this.transSet.bind(this)).filter(function(e){return null!=e});if(0<t.length)return{type:"ThenSetExpr"===e.type?"Serial":"Parallel",items:t}}else if("UnitSetExpr"===e.type){var r=e.params[0],a=this.defTypeInfo[r],s=this.parseSetExprParams(e.params[2]),n=s[0],i=s[1];if("text"!==a&&"button"!==a&&"path"!==a)return null;for(var o={type:"Unit",duration:n,defaultEasing:i,targetName:r,attrs:{}},p=0,l=e.params[1];p<l.length;p++){var u=l[p];this.transAsetter(a,u,o.attrs)}return o}},e.prototype.parseSetExprParams=function(e){var t=0,r=null;return"SetExprParams"===e.type&&(1<=e.params.length&&(t=this.parseTime2(e.params[0])),2<=e.params.length&&(r=this.parseString2(e.params[1]))),[t,r]},e.prototype.parseTime=function(e){if("SimpleValue"===e.type&&"time"===e.value.type)return this.parseTime2(e.value.value)},e.prototype.parseTime2=function(e){for(var t=!0,r=0,a=0,s="",n=null;;){if(null==(n=t?e.match(/^(\d*\.?\d+(?:[eE][\+\-]?\d+)?)(.*)$/):e.match(/^([hms]+)(.*)$/)))return r;if(s=n[1],t)a=parseFloat(s);else switch(s){case"h":r+=3600*a*1e3;break;case"m":r+=60*a*1e3;break;case"s":r+=1e3*a;break;case"ms":r+=a}e=n[2],t=!t}},e.prototype.parseObject=function(e){if("ComplexValue"===e.type&&"Object"===e.value.type)return this.parseObject2(e.value)},e.prototype.parseObject2=function(e){var t=e.params[0],r=e.params[1],a={};switch(t){case"seek":a.objType="seek";for(var s=0,n=r;s<n.length;s++){if("ASetter"===(c=n[s]).type){var i=c.params[0],o=c.params[1];switch(i){case"time":a.time=this.parseTime(o)}}}break;case"av":a.objType="av";for(
var p=0,l=r;p<l.length;p++){if("ASetter"===(c=l[p]).type){i=c.params[0],o=c.params[1];switch(i){case"av":a.av=this.parseInteger(o);break;case"page":a.page=this.parseInteger(o);break;case"time":a.time=this.parseTime(o)}}}break;case"bangumi":a.objType="bangumi";for(var u=0,h=r;u<h.length;u++){var c;if("ASetter"===(c=h[u]).type){i=c.params[0],o=c.params[1];switch(i){case"seasonId":a.seasonId=this.parseInteger(o);break;case"episodeId":a.episodeId=this.parseInteger(o);break;case"time":a.time=this.parseTime(o)}}}}return a},e.prototype.transAsetter=function(e,t,r){if("ASetter"===t.type&&2===t.params.length){var a=t.params[0],s=this.transAsetterValue(t.params[1]),n=s[0],i=s[1];if("text"===e)switch(a){case"x":case"y":case"alpha":case"color":case"fontSize":case"content":case"rotateX":case"rotateY":case"rotateZ":case"scale":r[a]={value:n,easing:i}}else if("button"===e)switch(a){case"x":case"y":case"fontSize":case"text":r[a]={value:n,easing:i}}else if("path"===e)switch(a){case"x":case"y":r[a]={value:n,easing:i}}}},e.prototype.transAsetterValue=function(e){return"SimpleValue"===e.type?[this.transValue(e.value),null]:"ComplexValue"===e.type&&"Array"===e.value.type&&2===e.value.params.length?[this.transValue(e.value.params[0]),this.parseString2(e.value.params[1])]:[null,null]},e.prototype.transValue=function(e){switch(e.type){case"String":return this.parseString2(e);case"Num":return this.parseNum2(e);case"hex":return this.parseInteger2(e)}},e}();var n=function(e,t){void 0===t&&(t=!0);var r={x:{numType:"number",value:0},y:{numType:"number",value:0},zIndex:0,scale:{numType:"number",value:1},duration:void 0},a={content:"请输入内容",alpha:{numType:"number",value:1},color:16777215,anchorX:{numType:"number",value:0},anchorY:{numType:"number",value:0},fontSize:{numType:"number",value:25},fontFamily:"SimHei",bold:1,textShadow:1,strokeWidth:0,strokeColor:16777215,rotateX:{numType:"number",value:0},rotateY:{numType:"number",value:0},rotateZ:{numType:"number",value:0},parent:void 0},s={text:"请输入内容",fontSize:{numType:"number",value:25},textColor:0,textAlpha:{numType:"number",value:1},fillColor:16777215,fillAlpha:{numType:"number",value:1},target:void 0},n={d:void 0,viewBox:void 0,borderColor:0,borderAlpha:{numType:"number",value:1},borderWidth:{numType:"number",value:0},fillColor:16777215,fillAlpha:{numType:"number",value:1}};try{var i=new m(f.parse(e),t).transform(),o={};o.defs=i.defs;for(var p=0;p<i.defs.length;p++)o.defs[p].attrs=l(r,i.defs[p].attrs),"DefText"===o.defs[p].type?o.defs[p].attrs=l(a,i.defs[p].attrs):"DefButton"===o.defs[p].type?o.defs[p].attrs=l(s,i.defs[p].attrs):"DefPath"===o.defs[p].type&&(o.defs[p].attrs=l(n,i.defs[p].attrs));return o.sets=i.sets,o}catch(e){throw new Error(e.message)}},s=r(0),o=r.n(s),p=function(){function e(e,t){void 0===e&&(e={}),this.paused=!0,this.sTime=0,this.dmList=[],this.cdmList=[],this.dmIndex=0,this.cTime=0,this.pTime=0,this.time0=0,this.pauseTime=0,this.testId=0,this.testDanmakus=[],this.worker=[],this.workerIndex=0,this.workerCount=2,this.inited=!1;var r={container:document.getElementById("player"),easing:"linear",visible:!0,fontFamily:"",timeSyncFunc:null};this.options=y.extend(r,e),this.player=t,this.container=this.options.container,this.paused=!0,this.sTime=0,this.inited=!1,this.dmList=[],this.cdmList=[],this.dmIndex=0,this.visibleStatus=this.options.visible,this.cTime=0,this.pTime=0,this.time0=0,this.pauseTime=0,this.startTime=(new Date).getTime(),this.testId=0;var a=y.browser.version;this.workerDisabled=a.safari&&!a.safariSupportMSE||!Worker||a.trident||a.edge||"chrome"===a.browser&&a.version<45}return e.prototype.init=function(){var e=this;if(!this.inited){var t;this.wrap=y.string2DOM('<div class="bas-danmaku '+(this.paused?"bas-danmaku-pause":"")+'"></div>'),this.container&&this.container.appendChild(this.wrap),this.inited=!0,this.resolutionWidth&&this.resolutionHeight&&this.resize(),window.requestAnimationFrame(function(){e.render()});var r=void 0,a=["webkit","moz","ms","o"];if("hidden"in document)t="hidden",r="visibilitychange";else for(var s=0;s<a.length;s++)a[s]+"Hidden"in document&&(
t=a[s]+"Hidden",r=a[s]+"visibilitychange");document.addEventListener(r,function(){document[t]||"function"==typeof e.options.timeSyncFunc&&e.seek(e.options.timeSyncFunc())})}},e.prototype.add=function(t){var r=this;if(t.dm instanceof Array){var a=0;t.dm.forEach(function(e){r.add({dm:e,parsed:t.parsed,test:t.test,noRefresh:!0,success:function(e){++a===t.dm.length&&(console.log("BAS added"),t.noRefresh||r.refresh())},error:function(){++a===t.dm.length&&(console.log("BAS added"),t.noRefresh||r.refresh())}})})}else{t.dm=$.extend({},t.dm);var s=function(e){r.inited||r.init(),t.test?(r.pretreatDanmaku(e,!0),r.testDanmakus.push(e),r.drawDanmaku(e)):(r.pretreatDanmaku(e),-1===e.stime&&(r.cTime?e.stime=r.cTime/1e3+.1:e.stime=r.options.timeSyncFunc()/1e3+.1),r.dmList.push(e),1!==r.dmList.length||r.paused||r.play(),t.noRefresh||r.refresh())};t.parsed?(s(t.dm),t.success&&t.success(t.dm)):this.parse({danmaku:t.dm,success:function(e){s(e),t.success&&t.success(e)},error:function(){t.error&&t.error()}})}},e.prototype.remove=function(t){this.dmList=this.dmList.filter(function(e){return e.dmid!==t}),this.refresh()},e.prototype.pretreatDanmaku=function(r,e){void 0===e&&(e=!1),e&&(r.dmid="test"+this.testId++,r.test=!0,r.stime=this.options.timeSyncFunc()/1e3),r.def2set={};for(var a=0;a<r.defs.length;a++){var t=r.defs[a].name,s=0;r.def2set[t]=[];for(var n=0;n<r.sets.length;n++)switch(r.sets[n].type){case"Serial":for(var i=0,o=0;o<r.sets[n].items.length;o++)r.sets[n].items[o].targetName===t&&(r.def2set[t].push({name:"bas-"+r.dmid+"-"+t+"-"+s,valueStart:this.getValueStart(o,s,r.def2set[t]),valueEnd:y.extend(this.getValueStart(o,s,r.def2set[t]),r.sets[n].items[o].attrs),easing:r.sets[n].items[o].defaultEasing||this.options.easing||"linear",duration:r.sets[n].items[o].duration/1e3,delay:i/1e3,group:n}),s++),i+=r.sets[n].items[o].duration;break;case"Parallel":for(o=0;o<r.sets[n].items.length;o++)r.sets[n].items[o].targetName===t&&(r.def2set[t].push({name:"bas-"+r.dmid+"-"+t+"-"+s,valueEnd:y.extend(this.getValueStart(o,s,r.def2set[t]),r.sets[n].items[o].attrs),easing:r.sets[n].items[o].defaultEasing||this.options.easing||"linear",duration:r.sets[n].items[o].duration/1e3,delay:0,group:n}),s++);break;case"Unit":r.sets[n].targetName===t&&(r.def2set[t].push({name:"bas-"+r.dmid+"-"+t+"-"+s,valueEnd:r.sets[n].attrs,easing:r.sets[n].defaultEasing||this.options.easing||"linear",duration:r.sets[n].duration/1e3,delay:0,group:n}),s++)}}var p=function(t){if({}.hasOwnProperty.call(r.def2set,t)){var e=r.defs.filter(function(e){return e.name===t})[0];e.attrs.duration?r.def2set[t].push({name:"bas-"+r.dmid+"-"+t+"-duration",valueEnd:{},easing:"linear",duration:e.attrs.duration/1e3,delay:0,group:-1}):0===r.def2set[t].length&&r.def2set[t].push({name:"bas-"+r.dmid+"-"+t+"-0",valueEnd:{},easing:"linear",duration:4,delay:0,group:-1})}};for(var l in r.def2set)p(l);for(var u in r.duration=0,r.def2set)if({}.hasOwnProperty.call(r.def2set,u)){r.setsIntervals={};var h=r.def2set[u].length;for(a=0;a<h;a++)if(r.def2set[u][a]){var c=[parseFloat(r.def2set[u][a].delay.toFixed(10)),parseFloat((r.def2set[u][a].delay+r.def2set[u][a].duration).toFixed(10)),r.def2set[u][a].group];for(var f in r.def2set[u][a].valueEnd)if(r.def2set[u][a].valueEnd.hasOwnProperty(f))if(-1!==["x","y","rotateX","rotateY","rotateZ","scale"].indexOf(f)&&(f="transform"),r.setsIntervals[f]){var m,d=r.setsIntervals[f].length,b=function(e){if(r.setsIntervals[f][e]){var t=r.setsIntervals[f][e][2];r.def2set[u][a].group!==t&&(r.setsIntervals[f][e][0]>c[0]&&r.setsIntervals[f][e][0]<c[1]||r.setsIntervals[f][e][1]>c[0]&&r.setsIntervals[f][e][1]<c[1]||r.setsIntervals[f][e][0]<=c[0]&&r.setsIntervals[f][e][1]>=c[1]&&r.setsIntervals[f][e][0]!==r.setsIntervals[f][e][1])&&c[0]!==c[1]&&(console.warn("BAS: attribute conflict, name: "+u+" attr: "+f+" time: "+c+" "+r.setsIntervals[f][e]),r.setsIntervals[f]=r.setsIntervals[f].filter(function(e){return e[2]!==t}),r.def2set[u]=r.def2set[u].filter(function(e){return e.group!==t}),e-=d-r.setsIntervals[f].length,d=r.setsIntervals[f].length,a-=h-r.def2set[u].length,h=r.def2set[u].length)}
m=e};for(n=0;n<d;n++)b(n),n=m;r.setsIntervals[f].push(c)}else r.setsIntervals[f]=[c]}for(a=0;a<r.def2set[u].length;a++){var g=r.def2set[u][a].delay+r.def2set[u][a].duration;g>r.duration&&(r.duration=g)}}},e.prototype.getValueStart=function(e,t,r){return 1<=e&&1<=t?r[t-1].valueEnd&&Object.keys(r[t-1].valueEnd).length?r[t-1].valueEnd:this.getValueStart(e-1,t-1,r):null},e.prototype.parse=function(t){var e=t.danmaku;if(this.workerDisabled)try{var r=n(e.text);e.defs=r.defs,e.sets=r.sets,t.success&&t.success(e)}catch(e){console.warn("Error in BAS parser: ",e),t.error&&t.error(e.message)}else{if(!this.workerIndex)for(var a=0;a<this.workerCount;a++)this.worker[a]=new o.a;var s=this.worker[this.workerIndex%this.workerCount];s.onmessage=function(e){e.data.error?t.error&&t.error(e.data.error):(e.data.defs=e.data.defs,e.data.sets=e.data.sets,t.success&&t.success(e.data))},s.postMessage(e),this.workerIndex++}},e.prototype.render=function(){var e=this;this.paused||(window.requestAnimationFrame(function(){e.render()}),this.renderDanmaku())},e.prototype.renderDanmaku=function(){this.updateTime(),this.refreshCdmList(),this.drawDanmaku()},e.prototype.updateTime=function(){this.pTime=this.cTime;var e=(new Date).getTime();this.cTime=this.time0+e-this.startTime;if("function"==typeof this.options.timeSyncFunc){var t=this.options.timeSyncFunc();(1e3<Math.abs(t-this.cTime)||isNaN(this.cTime))&&(this.cTime=t,this.pTime=t,this.time0=t,this.startTime=e,this.refresh())}},e.prototype.refreshCdmList=function(e){if(this.visibleStatus){if(e)this.refresh();else if(this.cdmList=[],Math.abs(this.cTime-this.pTime)<500)for(var t=0;t<this.dmList.length;t++)this.dmList[t].stime>=this.pTime/1e3&&this.dmList[t].stime<this.cTime/1e3&&this.cdmList.push(this.dmList[t])}else this.clear()},e.prototype.drawDanmaku=function(e,t){var r=this;if(void 0===e&&(e=this.cdmList),void 0===t&&(t=0),this.visibleStatus)if(this.inited||this.init(),e instanceof Array)e.forEach(function(e){r.drawDanmaku(e)});else{var a=$.extend(!0,{},e),s=this,n=new i({container:this.wrap,dm:a,startTime:t,animationEndCallback:function(t){t.dm.test&&(s.testDanmakus=s.testDanmakus.filter(function(e){return e.dmid!==t.dm.dmid}))},player:this.player});this.options.blockJudge&&this.options.blockJudge(n.dm)?n.ele.style.visibility="hidden":n.ele.style.visibility="",n.ele&&this.wrap.appendChild(n.ele)}},e.prototype.play=function(){this.time0=this.pauseTime,this.startTime=(new Date).getTime(),this.pauseTime=0,this.paused=!1,this.wrap&&this.wrap.classList.remove("bas-danmaku-pause"),this.dmList.length&&(this.inited||this.init(),this.render())},e.prototype.pause=function(){this.paused=!0,this.inited||this.init(),this.wrap.classList.add("bas-danmaku-pause");var e=(new Date).getTime();this.pauseTime=this.time0+e-this.startTime},e.prototype.toggle=function(){this.paused?this.play():this.pause()},e.prototype.seek=function(e,t){void 0===t&&(t=!0),this.testDanmakus=[],this.time0=1e3*e,this.startTime=(new Date).getTime(),this.inited||this.init(),this.dmList.length&&this.visibleStatus&&this.wrap&&(this.pTime=1e3*e,this.cTime=1e3*e,this.clear(),t&&this.refresh())},e.prototype.refresh=function(){this.clear();for(var e=this.pTime/1e3,t=0;t<this.dmList.length;t++)this.dmList[t].stime<e&&this.dmList[t].stime+this.dmList[t].duration>e&&this.drawDanmaku(this.dmList[t],e-this.dmList[t].stime);for(t=0;t<this.testDanmakus.length;t++)this.testDanmakus[t].stime<e&&this.testDanmakus[t].stime+this.testDanmakus[t].duration>e&&this.drawDanmaku(this.testDanmakus[t],e-this.testDanmakus[t].stime)},e.prototype.visible=function(e){e!==this.visibleStatus&&(e?(this.visibleStatus=!0,this.refresh(),this.render()):(this.visibleStatus=!1,this.clear()))},e.prototype.clear=function(){this.inited&&(this.cdmList=[],this.wrap&&(this.wrap.innerHTML=""))},e.prototype.resize=function(e,t){if(void 0===e&&(e=this.resolutionWidth),void 0===t&&(t=this.resolutionHeight),this.resolutionWidth=e,this.resolutionHeight=t,this.inited){var r=this.container.offsetWidth,a=this.container.offsetHeight;this.wrap.style.height=a/t<r/e?(
this.wrap.style.width=a/t*e/r*100+"%","100%"):(this.wrap.style.width="100%",r/e*t/a*100+"%")}this.refresh()},e}();t.default=p}]).default});